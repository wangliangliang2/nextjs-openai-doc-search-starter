<div> <main role="main"> <article role="article" aria-labelledby="title_cun_ayf_gz5"> <div> <p class="shortdesc">本教程介绍如何在安装了CentOS 7.2系统的QVM实例上，安装Node.js并部署项目。</p> <div> <div> <h1 font-weigh = "bold">前提条件</h1> </div> <ul class="ul" id="ul-1bz-4pp-zxy"> <li>用于连接QVM实例的机器上已安装PuTTY。下载地址：<a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/" target="_blank">PuTTY</a>。 </li> <li>已注册七牛云账号。如还未注册，请先完成<a href="https://portal.qiniu.com/signup?ref=developer.qiniu.comregister.htm?" target="_blank">账号注册</a>。 </li> </ul> </div> <section class="section context" id="context-64q-ajb-csm"> <div> <h1 font-weigh = "bold">背景信息</h1> </div> <div>Node.js是一个基于Chrome V8引擎的JavaScript运行环境，用来方便快速地搭建易于扩展的网络应用。Node.js使用了一个事件驱动、非阻塞式I/O的模型，使其轻量又高效，非常适合运行在分布式设备的数据密集型的实时应用。Node.js的包管理器npm，是全球最大的开源库生态系统。Node.js的典型应用场景包括： <ul class="ul" id="ul-6yk-y99-enm"> <li>实时应用：如在线聊天，实时通知推送等等（例如socket.io）。</li> <li>分布式应用：通过高效的并行I/O使用已有的数据。</li> <li>工具类应用：海量的工具，小到前端压缩部署（例如grunt），大到桌面图形界面应用程序。</li> <li>游戏类应用：游戏领域对实时和并发有很高的要求（例如网易的pomelo框架）。</li> <li>Web渲染：利用稳定接口提升Web渲染能力。</li> <li>前后端编程语言环境统一：前端开发人员可以非常快速地切入到服务器端的开发（例如著名的纯Javascript全栈式MEAN架构）。</li> </ul> </div> </section> <section class="section" id="section-z74-yzt-kll"> <h1 font-weigh = "bold">操作步骤</h1> <div>在QVM实例上安装Node.js并部署项目的操作步骤如下： <ol class="ol" id="ol-vpd-he6-xbo"> <li><a title="" href="#section-e0r-tml-c8k">步骤一：创建并连接QVM实例</a></li> <li><a title="" href="#section-tug-p3l-h9l">步骤二：部署Node.js环境</a></li> <li><a title="" href="#section-igz-e58-4zq">步骤三：部署测试项目</a></li> </ol> </div> </section> <section class="section" id="section-e0r-tml-c8k"> <h1 font-weigh = "bold">步骤一：创建并连接QVM实例</h1> <p class="p" id="p-7dw-1vk-bqs">完成以下操作，创建并连接QVM实例：</p> <ol class="ol steps" id="steps-4io-fyb-xb0"> <li><span>使用公共镜像CentOS 7.2 64位，创建QVM实例。</span></li> <li><span>使用<span>root</span>用户连接QVM实例。</span></li> </ol> </section> <section class="section" id="section-tug-p3l-h9l"> <h1 font-weigh = "bold">步骤二：部署Node.js环境</h1> <div>选择以下任意一种方法部署Node.js环境。 <ul class="ul" id="ul-odf-cg5-alr"> <li>使用NVM安装多版本。 <p class="p" id="p-drz-hjo-jmp">NVM（Node Version Manager）是Node.js的版本管理软件，使您可以轻松在Node.js各个版本间进行切换。适用于长期做node开发的人员或有快速更新node版本、快速切换node版本的场景。</p> <div>完成以下操作，使用NVM安装多个Node.js版本： <ol class="ol" id="ol-5v0-i9x-5r7"> <li>使用git将源码克隆到本地的<span>~/.nvm</span>目录下，并检查最新版本。 <pre><code>yum install gitgit clone https://github.com/cnpm/nvm.git ~/.nvm &amp;&amp; cd ~/.nvm &amp;&amp; git checkout `git describe --abbrev=0 --tags`</code></pre> </li> <li>激活NVM。 <pre><code>echo ". ~/.nvm/nvm.sh" &gt;&gt; /etc/profilesource /etc/profile</code></pre> </li> <li>列出Node.js的所有版本。 <pre><code>nvm list-remote</code></pre> </li> <li>安装多个Node.js版本。 <pre><code>nvm install v6.9.5nvm install v7.4.0</code></pre> </li> <li>运行<code>nvm ls</code>查看已安装的Node.js版本。 <p class="p" id="p-t97-q0z-2lk">本示例使用的版本为v7.4.0。返回结果如下所示。</p> <pre><code>[root@iZXXXXZ .nvm]# nvm ls v6.9.5-&gt; v7.4.0 systemstable -&gt; 7.4 (-&gt; v7.4.0) (default)unstable -&gt; 6.9 (-&gt; v6.9.5) (default)</code></pre> </li> <li>运行<code>nvm use &lt;版本号&gt;</code>可以切换Node.js版本。 <p class="p" id="p-z66-872-gy7">例如，切换Node.js版本至v7.4.0。返回结果如下所示。</p> <pre><code>[root@iZXXXXZ .nvm]# nvm use v7.4.0Now using node v7.4.0</code></pre> </li> </ol> </div> </li> <li>使用二进制文件安装。 <p class="p" id="p-2kp-0ba-yrf">该部署过程使用的安装包是已编译好的二进制文件。解压之后，在bin文件夹中就已存在node和npm，无需重复编译。</p> <div> 完成以下操作，使用二进制文件部署Node.js环境： <ol class="ol" id="ol-4u7-zgy-c96"> <li>下载Node.js安装包。 <pre><code>wget https://nodejs.org/dist/v6.9.5/node-v6.9.5-linux-x64.tar.xz</code></pre> </li> <li>解压文件。 <pre><code>tar xvf node-v6.9.5-linux-x64.tar.xz</code></pre> </li> <li>创建软链接，您就可以在任意目录下直接使用node和npm命令。 <pre><code>ln -s /root/node-v6.9.5-linux-x64/bin/node /usr/local/bin/nodeln -s /root/node-v6.9.5-linux-x64/bin/npm /usr/local/bin/npm</code></pre> </li> <li>查看node、npm版本。 <pre><code>node -vnpm -v</code></pre> <p class="p" id="p-sq5-xmu-d9m">至此，Node.js环境已安装完毕。软件默认安装在<span>/root/node-v6.9.5-linux-x64/</span>目录下。 </p> </li> <li>如果需要将该软件安装到其他目录（例如：<span>/opt/node/</span>）下，请进行如下操作： <pre><code>mkdir -p /opt/node/mv /root/node-v6.9.5-linux-x64/* /opt/node/rm -f /usr/local/bin/noderm -f /usr/local/bin/npmln -s /opt/node/bin/node /usr/local/bin/nodeln -s /opt/node/bin/npm /usr/local/bin/npm</code></pre> </li> </ol> </div> </li> </ul> </div> </section> <section class="section" id="section-igz-e58-4zq"> <h1 font-weigh = "bold">步骤三：部署测试项目</h1> <ol class="ol steps" id="steps-vx3-eda-6i2"> <li><span>新建项目文件<span>example.js</span>。</span> <div> <pre><code>cd ~touch example.js</code></pre> </div> </li> <li><span>修改项目文件<span>example.js</span>。</span> <ol type="a" class="ol substeps" id="substeps-29j-rgu-tia"> <li><span>运行以下命令打开<span>example.js</span>。</span> <div> <pre><code>vim example.js</code></pre> </div> </li> <li><span>按<kbd>i</kbd>进入编辑模式。</span></li> <li><span>将以下项目文件内容粘贴到文件中。</span> <div> <pre><code>const http = require('http');const hostname = '0.0.0.0';const port = 3000;const server = http.createServer((req, res) =&gt; { res.statusCode = 200; res.setHeader('Content-Type', 'text/plain'); res.end('Hello World\n');}); server.listen(port, hostname, () =&gt; { console.log(`Server running at http://${hostname}:${port}/`);});</code></pre> <div> <div><i class="icon-note note"></i></div> <div><strong>说明</strong> 本示例中，项目配置的端口号为3000。实际应用过程中，您可以自行配置端口号，但是必须在QVM实例安全组的入方向添加安全组规则，放行您配置的端口号。 </div> </div> </div> </li> <li><span>按<kbd>Esc</kbd>退出编辑模式，然后输入<kbd>:wq</kbd>并回车以保存并关闭文件。</span></li> </ol> </li> <li><span>运行项目并得到项目的端口号。</span> <div> <pre><code>node ~/example.js &amp;</code></pre> </div> </li> <li><span>运行以下命令查看是否在监听项目端口。</span> <div> <pre><code>netstat -tpln</code></pre> </div> <div>本示例中，返回的结果列表中包含端口3000，表明项目正常运行。</div> </li> <li><span>登录<a href="https://ecs.console.aliyun.com" target="_blank">QVM管理控制台</a>，并在QVM实例安全组的入方向添加规则，放行项目中配置的端口（本示例中端口号为3000）。</span> </li> <li><span>在本地机器的浏览器中输入<code>http://&lt;QVM实例公网IP地址&gt;:端口号</code>访问项目。</span> <div><img class="image break" id="image-1gt-ao5-5o9" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/Mb40or3yfg2lj7ZY1wIS.png"></div> </li> </ol> </section> </div> <nav role="navigation" class="related-links" cond-props="china"> <div> </div> </div>