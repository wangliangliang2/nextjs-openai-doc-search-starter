<div>
<main role="main">         <article role="article" aria-labelledby="title_wvj_gsa_9vp">            <div>               <p class="shortdesc">本教程介绍如何通过QVM实例部署RabbitMQ。</p>               <div>                  <div>                     <h1 font-weigh = "bold">前提条件</h1>                  </div>                  <ul class="ul" id="ul-q2t-6f0-36l">                     <li>已注册七牛云账号。如还未注册，请先完成<a href="https://portal.qiniu.com/signup?ref=developer.qiniu.comregister.htm?" target="_blank">账号注册</a>。
                     </li>                     <li>已创建网络类型为专有网络的安全组，并且安全组的入方向添加规则并放行80、5672及15672端口，如果您使用SSH远程连接Linux实例，还需要放行22端口。 具体操作请参见<a title="您可以通过添加安全组规则，允许或禁止安全组内的QVM实例对公网或私网的访问。" href="https://developer.qiniu.com/qvm/manual/7107/commonly-used-port-security-group#concept-sm5-2wz-xdb">添加安全组规则</a>。
                     </li>                  </ul>               </div>               <section class="section context" id="context-2ka-8kk-mq5">                  <div>                     <h1 font-weigh = "bold">背景信息</h1>                  </div>                  <p class="p" id="p-h9r-c56-0hv">RabbitMQ是实现了高级消息队列协议（AMQP）的开源消息代理软件，用于在分布式系统中存储转发消息，有良好的易用性、扩展性和高可用性。RabbitMQ使用Erlang语言编写服务器端，并支持多种客户端，如Python、Ruby、.NET、Java、JMS、C、PHP、ActionScript、XMPP和STOMP，同时也支持AJAX。</p>                  <div>您可以通过以下方式部署RabbitMQ。 
                     <ul class="ul" id="ul-msv-74p-d5z">                         <li>手动部署：适合对Linux命令有基本了解的用户，能够个性化部署。具体操作，请参见<a title="" href="#section-gr4-zy1-ffb">手动部署RabbitMQ</a>。 
                           <div>手动部署使用以下操作系统和软件版本： 
                              <ul class="ul" id="ul-lng-c0i-r6e">                                 <li>操作系统：公共镜像CentOS 7.3 64位</li>                                 <li>RabbitMQ版本：rabbitmq-server -3.6.9</li>                                 <li>erlang版本：erlang19.3</li>                                 <li>JDK版本：JDK1.8.0_121</li>                              </ul>                           </div>                        </li>                     </ul>                  </div>               </section>               <section class="section" cond-props="china" id="section-market-image">                 <h1 font-weigh = "bold">手动部署RabbitMQ</h1>                  <ol class="ol steps" id="steps-v9g-gmg-wks">                     <li><span>安装依赖包。 </span><div><pre><code>yum -y install make gcc gcc-c++ m4 ncurses-devel openssl-devel unixODBC-devel</code></pre></div>                     </li>                     <li><span>安装erlang。</span><ol type="a" class="ol substeps" id="substeps-kyy-mra-i5s">                           <li><span>下载erlang安装包。</span><div><pre><code>wget http://erlang.org/download/otp_src_19.3.tar.gz</code></pre></div>                           </li>                           <li><span>解压缩erlang安装包。</span><div><pre><code>tar xzf otp_src_19.3.tar.gz</code></pre></div>                           </li>                           <li><span>创建一个文件夹。</span><div><pre><code>mkdir /usr/local/erlang</code></pre></div>                           </li>                           <li><span>编译并安装erlang。</span><div><pre><code># cd otp_src_19.3
# ./configure --prefix=/usr/local/erlang --without-javac
# make &amp;&amp; make install</code></pre></div>                           </li>                        </ol>                     </li>                     <li><span>修改<span>profile</span>配置文件。</span><ol type="a" class="ol substeps" id="substeps-ule-jlo-8tv">                           <li><span>运行命令<span>vi /etc/profile</span>打开<span>profile</span>配置文件。</span></li>                           <li><span>按下<kbd>i</kbd>键，然后在文件末尾处添加如下内容：</span><div><pre><code>export PATH=$PATH:/usr/local/erlang/bin</code></pre></div>                           </li>                           <li><span>按下<kbd>Esc</kbd>键，然后输入<code>:wq</code>并回车，保存并关闭文件。</span></li>                        </ol>                     </li>                     <li><span>生效环境变量并检查。</span><ol type="a" class="ol substeps" id="substeps-b1v-h9r-w0u">                           <li><span>运行命令<span>source /etc/profile</span>使环境变量生效。</span></li>                           <li><span>运行命令<span>erl -version</span>检查安装结果。</span></li>                        </ol>                     </li>                     <li><span>下载并安装RabbitMQ。</span><ol type="a" class="ol substeps" id="substeps-hfp-i62-h4s">                           <li><span>下载RabbitMQ安装包。</span><div><pre><code>wget -P /root "https://www.rabbitmq.com/releases/rabbitmq-server/v3.6.9/rabbitmq-server-3.6.9-1.el7.noarch.rpm"</code></pre></div>                           </li>                           <li><span>导入签名密钥。</span><div><pre><code>sudo rpm --import https://www.rabbitmq.com/rabbitmq-release-signing-key.asc</code></pre></div>                           </li>                           <li><span>安装RabbitMQ Server。</span><div><pre><code># cd /root
# sudo yum install rabbitmq-server-3.6.9-1.el7.noarch.rpm</code></pre></div>                           </li>                        </ol>                     </li>                     <li><span>配置RabbitMQ。</span><ol type="a" class="ol substeps" id="substeps-ei9-kcv-a1r">                           <li><span>允许RabbitMQ开机自启动。</span><div><pre><code>sudo systemctl enable rabbitmq-server</code></pre></div>                           </li>                           <li><span>启动RabbitMQ。</span><div><pre><code>sudo systemctl start rabbitmq-server</code></pre></div>                           </li>                           <li><span>为保证数据安全，建议您删除默认用户。</span><div>RabbitMQ默认的账号用户名和密码都是guest。 <pre><code>sudo rabbitmqctl delete_user guest</code></pre></div>                           </li>                           <li><span>创建管理员用户</span><div>                                 <ol class="ol" type="i" id="ol-7ac-gn5-ajg">                                    <li>创建一个新用户。 <pre><code>sudo rabbitmqctl add_user &lt;用户名&gt; &lt;密码&gt;</code></pre></li>                                    <li>将创建的新用户设置为管理员。 <pre><code>sudo rabbitmqctl set_user_tags &lt;用户名&gt; administrator</code></pre></li>                                    <li>赋予新创建的用户所有权限。 <pre><code>sudo rabbitmqctl set_permissions -p / &lt;用户名&gt; ".*" ".*" ".*"</code></pre></li>                                 </ol>                              </div>                           </li>                        </ol>                     </li>                     <li><span>运行以下命令，启用RabbitMQ的web管理界面。 </span><div><pre><code>sudo rabbitmq-plugins enable rabbitmq_management</code></pre></div>                     </li>                     <li><span>使用浏览器访问<code>http://公网IP:15672</code>。</span><div>显示如下页面，说明RabbitMQ安装成功。
<img class="image break" id="image-kdi-vnz-zbu" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-17/asSOgxpFzGJnvDmQyec6.png" alt="RabbitMQ登录页"></div>                     </li>                     <li><span>输入之前创建的用户名和密码后单击<span>Login</span>，进入RabbitMQ管理界面。</span><div><img class="image break" id="image-0rv-xwo-v43" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-17/bymJlGksWzeAKUqvOTID.png" alt="RabbitMQ主页"></div>                     </li>                  </ol>               </section>            </div>         </article>      </main>   


</div>  </div>  	