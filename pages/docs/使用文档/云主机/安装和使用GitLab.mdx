 <div>      <main role="main">         <article role="article" aria-labelledby="title_aw0_8fq_j1l">            	                        	            	            <div>               <p class="shortdesc">GitLab是Ruby开发的自托管的Git项目仓库，可通过Web界面访问公开的或者私人的项目。本教程介绍如何安装和使用GitLab。</p>               		               <div>                  <div>                     <h1 font-weigh = "bold">前提条件</h1>                  </div>                  			                  <p class="p" cond-props="china" id="p-mcj-d0z-980">使用本教程进行操作前，请确保您已经注册了七牛云账号。如还未注册，请先完成<a href="https://portal.qiniu.com/signup?ref=developer.qiniu.comregister.htm?" target="_blank">账号注册</a>。                  </p>                  			                  			                  			                  <div>您已创建部署GitLab的实例，要求如下：                      				                     <ul class="ul" id="ul-pyc-i8m-t07">                        					                        <li>部署GitLab的实例要求至少使用2个vCPU和4GiB的内存，本示例中使用的相关资源版本如下。                            						                           <ul class="ul" id="ul-3nz-qud-w1v">                              							                              <li>实例规格：ecs.c6.large</li>                              							                              <li>操作系统：CentOS 7.2 64位</li>                              						                           </ul>                           					                        </li>                        					                        <li>已添加如下表所示的安全组规则。         						                           <table><thead><tr><th>方向</th><th>协议/应用</th><th>端口/范围</th><th>源地址</th></tr></thead><tbody><tr><td>入方向</td><td>HTTP(80)</td><td>80</td><td>0.0.0.0/0</td></tr></tbody></table>                                                      									                             					                        </li>                        				                     </ul>                     			                  </div>                  		               </div>               		               <section class="section" cond-props="china" id="section-gno-olp-zdk">                  <h1 font-weigh = "bold">使用镜像部署GitLab环境</h1>                  			                  			                  <ol class="ol steps" id="steps-jyy-5m1-xfq">                     <li><span>进入<a href="https://market.aliyun.com/products/55530001/jxsc000067.html?spm=5176.730005.0.0.LuTu" target="_blank">GitLab代码管理（Centos 64位 | GitLab）</a>镜像详情页面，单击<span>立即购买</span>，然后按界面提示完成配置选型并购买QVM实例。</span></li>                     <li><span>远程连接QVM实例。连接方式请参见<a title="云服务器QVM支持通过多种方式连接实例，包括Workbench、VNC和第三方客户端工具。您可以综合考虑目标实例的操作系统、本地设备的操作系统、需要执行的操作等因素，选择合适的连接方式。" href="https://developer.qiniu.com/qvm/manual/4308/qvm-login">连接方式概述</a>。</span></li>                     <li><span>运行<span>/alidata</span>目录下的<span>gitlab_opennet.sh</span>脚本，开启远程访问。</span>                        					                        <div>                           						                           <div>                              <div><i class="icon-note notice"></i></div>                              <div><strong>注意</strong> GitLab镜像部署成功后默认禁止远程访问。您需要开启远程访问，才能通过QVM服务器的公网IP地址访问GitLab的登录界面。                             </div>                           </div>                           					                        </div>                        				                     </li>                     <li><span>登录<a href="https://portal.qiniu.com/qvm/dashboard" target="_blank">QVM管理控制台</a>。</span></li>                     <li><span>在左侧导航栏，单击<span><span>实例与镜像</span><abbr> &gt; </abbr><span>实例</span></span>。</span></li>                     <li><span>在顶部菜单栏左上角处，选择地域。 </span></li>                     <li><span>在<span>实例列表</span>页面，找到所购QVM实例，并在<span>IP 地址</span>列获取该实例的公网IP地址。</span></li>                     <li><span>在浏览器地址栏输入公网IP地址，访问GitLab主页。</span></li>                  </ol>                  		               </section>               		               <section class="section" id="section-yyy-uy3-t68">                  <h1 font-weigh = "bold">手动部署GitLab环境</h1>                  			                  			                  <ol class="ol steps" id="steps-a9g-l0i-9c5">                     <li><span>安装依赖包。</span>                        					                        <div>                           						<pre><code>sudo yum install -y curl policycoreutils-python openssh-server</code></pre>                           					</div>                        				                     </li>                     <li><span>设置SSH开机自启动并启动SSH服务。 </span>                        					                        <div>                           						<pre><code>sudo systemctl enable sshd
sudo systemctl start sshd</code></pre>                           					</div>                        				                     </li>                     <li><span>安装Postfix来发送通知邮件。</span>                        					                        <div>                           						<pre><code>sudo yum install postfix</code></pre>                           					</div>                        				                     </li>                     <li><span>设置Postfix开机自启动。</span>                        					                        <div>                           						<pre><code>sudo systemctl enable postfix</code></pre>                           					</div>                        				                     </li>                     <li><span>启动Postfix服务。</span>                        					                        <ol type="a" class="ol substeps" id="substeps-7la-uuo-1fc">                           						                           <li><span>运行命令<code>vim /etc/postfix/main.cf</code>打开<span>main.cf</span>文件，找到下图内容：</span>                              							                              <div><img class="image break" id="image-642-tce-yhv" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/Et1espQqIkaiB5zZ7Vo9.png" alt="set_inet"></div>                              						                           </li>                           						                           <li><span>按<kbd>i</kbd>进入编辑模式。</span></li>                           						                           <li><span>将这行代码改为<code>inet_interfaces = all</code>。</span></li>                           						                           <li><span>按<kbd>Esc</kbd>退出编辑模式，然后输入<kbd>:wq</kbd>并回车以保存并关闭文件。</span></li>                           						                           <li><span>运行命令<code>sudo systemctl start postfix</code>启动Postfix服务。</span></li>                           					                        </ol>                        				                     </li>                     <li><span>添加GitLab软件包仓库。</span>                        					                        <div>                           						<pre><code>&nbsp;curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash</code></pre>                           					</div>                        				                     </li>                     <li><span>安装GitLab。</span>                        					                        <div>                           						<pre><code>sudo EXTERNAL_URL="GitLab服务器的公网IP地址" yum install -y gitlab-ce</code></pre>                           						<div>                              <div><i class="icon-note note"></i></div>                              <div><strong>说明</strong> 您可从QVM管理控制台的<span>实例列表</span>页面找到GitLab服务器的公网IP地址。                              </div>                           </div>                           					                        </div>                        				                     </li>                     <li><span>使用浏览器访问GitLab服务器的公网IP地址。</span>                        					                        <div>返回页面如下图所示，表示环境搭建成功，并且您需要设置新密码。<img class="image break" id="image-ypk-mbc-2f2" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/pcX14xGskiSD5eAQUTRm.png" alt="gitlab1"></div>                        				                     </li>                  </ol>                  		               </section>               		               <section class="section" id="section-6r1-7kt-txz">                  <h1 font-weigh = "bold">使用GitLab</h1>                  			                  			                  <ol class="ol steps" id="steps-390-2gv-eqm">                     <li><span>登录GitLab。</span>                        					                        <div>在浏览器的地址栏中，输入QVM服务器的公网IP即可进入GitLab的登录界面，首次登录使用用户名<code>root</code>，密码为首次访问GitLab时设置的新密码。<img class="image break" id="image-9iq-v26-phn" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/Q7PkhwqI8RiojFEmB1rN.png" alt="gl2"></div>                        					                        <div>登录成功后界面如下。<img class="image break" id="image-gc0-8bb-w1u" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/AJvIeF3DKYtmzXGQHjrb.png" alt="gl3"></div>                        				                     </li>                     <li><span>创建Project。</span>                        					                        <ol type="a" class="ol substeps" id="substeps-uw8-sos-w8e">                           						                           <li><span>使用Linux自带的软件源安装Git工具。</span>                              							                              <div>                                 								<pre><code>yum install git</code></pre>                                 								<img class="image break" id="image-7a0-7s5-jj2" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/rtnfYzxAgFMpcH62ZuP9.png" width="420" alt="install_git"></div>                              						                           </li>                           						                           <li><span>生成密钥文件。</span>                              							                              <div>使用如下命令生成密钥文件<span>.ssh/id_rsa</span>。                                  								<pre><code>ssh-keygen</code></pre>                                 <img class="image break" id="image-6b0-hvw-iwh" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/kcabW1LVuX6dCNy5vSw4.png" width="420" alt="密钥">使用如下命令查看公钥文件<span>id_rsa.pub</span>中的内容。在下一步操作中，您需要粘贴该内容到GitLab服务器的SSH-key的配置文件中。                                  								<pre><code>cat .ssh/id_rsa.pub</code></pre>                                 <img class="image break" id="image-t1x-1fm-qeg" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/iewhEDV04G6bXa7ofs2J.png" width="420" alt="公钥"></div>                              						                           </li>                           						                           <li><span>在GitLab的主页中新建一个Project。</span>                              							                              <div><img class="image break" id="image-4yg-0vt-tib" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/V2wprcbYCMnfXqsG1y34.png" width="420" alt="new_project">
<img class="image break" id="image-6jc-fgg-dkc" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/esvlh8pJ0YIdO6ncCFzx.png" width="420" alt="new_project_2">
	</div>                              						                           </li>                           						                           <li><span>添加ssh key，导入步骤2中生成的密钥文件内容。</span>                              							                              <div><img class="image break" id="image-n36-15z-ltb" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/7EGlLAjqTHySUkO0znXf.png" width="420" alt="import-sshkey-1">
<img class="image break" id="image-zed-c0i-1v5" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/WYd8kmr7EMKZ50jgSUA4.png" width="420" alt="import-sshkey-2">
</div>                              							                              <div>ssh key添加完成后，如下图所示。
<img class="image break" id="image-65c-rv8-id3" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/QpYu5W8K3lqMOoEvJah0.png" width="420" alt="import-ssh-key-complete">
</div>                              						                           </li>                           						                           <li><span>保存项目地址，该地址在进行克隆操作时需要用到。</span>                              							                              <div><img class="image break" id="image-2pz-5jt-tom" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/d1MDUVkquceyjZv5iJrf.png" width="420" alt="项目地址"></div>                              						                           </li>                           					                        </ol>                        				                     </li>                     <li><span>简单配置。</span>                        					                        <ol type="a" class="ol substeps" id="substeps-c4t-4r9-yaq">                           						                           <li><span>配置使用Git仓库的人员姓名。</span>                              							                              <div>                                 								<pre><code>git config --global user.name "testname" </code></pre>                                 							</div>                              						                           </li>                           						                           <li><span>配置使用Git仓库的人员email，填写自己的公司邮箱。</span>                              							                              <div>                                 								<pre><code>git config --global user.email "abc@example.com" </code></pre>                                 							</div>                              						                           </li>                           						                           <li><span>克隆项目，在本地生成同名目录，并且目录中会有所有的项目文件。 </span>                              							                              <div>                                 								<pre><code>git clone git@iZxxxxxxxxxxxxxxxxx3Z:root/test.git</code></pre>                                 								<img class="image break" id="image-qfm-rqc-d8j" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/CnJKA7cSxQa3rqVsPG40.png" width="420" alt="简单配置">
	</div>                              						                           </li>                           					                        </ol>                        				                     </li>                     <li><span>上传文件。</span>                        					                        <ol type="a" class="ol substeps" id="substeps-ysb-k7k-aio">                           						                           <li><span>进入到项目目录。</span>                              							                              <div>                                 								<pre><code>cd test/ </code></pre>                                 							</div>                              						                           </li>                           						                           <li><span>创建需要上传到GitLab中的目标文件。</span>                              							                              <div>                                 								<pre><code>echo "test" &gt; /root/test.sh</code></pre>                                 							</div>                              						                           </li>                           						                           <li><span>将目标文件或者目录复制到项目目录下。</span>                              							                              <div>                                 								<pre><code>cp /root/test.sh ./ </code></pre>                                 								<img class="image break" id="image-8yt-emh-6cq" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/QYMJrkKuBCSR7b8nFzI0.png" width="420" alt="上传文件">
</div>                              						                           </li>                           						                           <li><span>将<span>test.sh</span>文件加入到索引中。 </span>                              							                              <div>                                 								<pre><code>git add test.sh</code></pre>                                 							</div>                              						                           </li>                           						                           <li><span>将<span>test.sh</span>提交到本地仓库。</span>                              							                              <div>                                 								<pre><code>git commit -m "test.sh"</code></pre>                                 							</div>                              						                           </li>                           						                           <li><span>将文件同步到GitLab服务器上。</span>                              							                              <div>                                 								<pre><code>git push -u origin master</code></pre>                                 								<img class="image break" id="image-i1h-3ji-c1k" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/QjTR0LJGxe1CpMi3rzcY.png" width="420" alt="文件同步命令"></div>                              							                              <div>在网页中查看上传的<span>test.sh</span>文件已经同步到GitLab中。
<img class="image break" id="image-kr3-tmy-jau" src="http://qey2kbifv.hn-bkt.clouddn.com/2020-09-04/jEcWg4BhYMrAt7OnxXH6.png" width="420" alt="文件同步结果">
	</div>                              						                           </li>                           					                        </ol>                        				                     </li>                  </ol>                  		               </section>               	            </div>                     </article>      </main>   <script>$icmsDocProps={'productMethod':'created','language':'zh-CN',};</script></div>  </div>  	