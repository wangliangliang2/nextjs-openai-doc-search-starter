迁徙图是在地图中动态、实时地展示数据的迁徙轨迹和迁徙量级，直观查看数据的来源和去向，包括中国迁徙图和世界迁徙图，两者区别为地图展示的地理范围不同，两者样式配置均相同。迁徙图常用于流量监控、安全攻击来源监控等场景。迁徙图分为迁徙图（中国）、迁徙图（世界）

### **样式配置说明**
迁徙图的配置项均由数据、图表样式、颜色3部分组成

#### **数据**
数据用于选择迁徙图需要展示的字段相关信息

|配置项|说明|
|-|-|
|起始节点|用于选择迁徙路径的起点|
|目的节点|用于选择迁徙路径的终点|
|统计指标|展示的字段，可以设置其单位和精度|

#### **图表样式**
图表的样式配置

|配置项|说明|
|-|-|
|气泡直径|支持动态取值和固定取值两种方式设置气泡直径长度大小，动态值表示根据气泡字段值的最小值设置最小直径，最大值设置最大直径。固定值表示可设置固定字段值的气泡直径大小|

#### **颜色**
颜色用于设置展示的起始节点和目的节点气泡颜色，以及支持设置迁徙线颜色：包括推荐色、单色渐变和多色渐变

### **场景示例**
#### **迁徙图（中国）**
查询某商品不同省份的进出口情况
``` 
| makeresults count=8
| streamstats count() as id
| eval from_ip=case(id==1, "163.125.30.129", id==2, "218.75.102.198", id==3, "61.151.178.150", id==4, "119.167.66.22",id==5, "117.65.1.12",id==6, "222.74.202.233",id==7, "49.89.85.168", "39.105.205.245")
| eval to_ip=case( id==1, "218.75.102.198", id==2, "61.151.178.150", id==3, "119.167.66.22",id==4, "117.65.1.12",id==5, "222.74.202.233",id==6, "163.125.30.129",id==7, "39.105.205.245","49.89.85.168")
| eval sales=case(id==1, 73, id==2, 753, id==3, 524, id==4, 91,id==5, 919,id==6, 858,id==7, 76, 856)
| iplocation prefix="from_" from_ip 
| iplocation prefix="to_" to_ip
```
- 起始节点选择from_city，目的节点选择to_city，统计指标选择sales,绘制中国迁徙图
![image.png](https://dn-odum9helk.qbox.me/FpwmAJOeqUM7w-maUzgfaZGH9PA0)

#### **迁徙图（世界）**
查询某商品不同国家的进出口情况
```
| makeresults count=8
| streamstats count() as id
| eval from_ip=case(id==1, "130.253.37.97", id==2, "125.17.14.100", id==3, "128.241.220.82", id==4, "27.102.11.11",id==5, "195.216.243.24",id==6, "12.130.60.4",id==7, "217.132.169.69", "194.146.236.22")
| eval to_ip=case( id==1, "125.17.14.100", id==2, "128.241.220.82", id==3, "27.102.11.11",id==4, "195.216.243.24",id==5, "130.253.37.97",id==6, "194.146.236.22",id==7,"12.130.60.4","217.132.169.69")
| eval sales=case(id==1, 73, id==2, 753, id==3, 524, id==4, 91,id==5, 919,id==6, 858,id==7, 76, 856)
| iplocation prefix="from_" from_ip 
| iplocation prefix="to_" to_ip
```
- 起始节点选择from_country，目的节点选择to_country，统计指标选择sales,绘制世界迁徙图
![image.png](https://dn-odum9helk.qbox.me/Fv4-TdqlqzUPUp84mabC4c0vOhll)
