桑基图是一种特定类型的流图，用于描述一组值到另一组值的流向，适用于分析网络流量流向等场景。
适合用桑基图描述的数据包含起始节点 、 结束节点和指标，如果日志中包含这三个字段，即可以用桑基图分析数据的流向。

![](https://pandora-kibana.qiniu.com/report/sankey_pattern2.png)

图中延伸的分支宽度对应数据流量的大小。桑基图的特点如下：

* 起始流量和结束流量相同，所有主支宽度的总和与所有分出去的分支宽度总和相等，保持能量的平衡；特殊地，智能日志平台支持用桑基图展示起始流量和结束流量不同的数据，表现为[多级链路桑基图](https://developer.qiniu.com/insight/manual/5884/the-sankey-diagram#2)。

* 在内部，不同的线条代表了不同的流量分流情况，它的宽度成比例地显示此分支占有的流量；

* 节点不同的宽度代表了特定状态下的流量大小。

**使用步骤：**

1.在搜索栏输入搜索条件，点击右侧的查询按钮；

2.在选择图表类型为`桑基图`；

3.指标与分组配置里配置好需要显示的分组字段与指标；

4.设置图表样式。

**桑基图样式设置**

|配置项|说明|
|:-:|:-:|
|展示指标|若添加多个计算指标，可切换用以展示的指标|
|数值单位|支持完整的单位体系，对图表的单位进行切换|
|图表形式|切换图表形式为`二级链路桑基图`和`多级链路桑基图`|

# 二级链路桑基图
二级链路桑基图，顾名思义，图中只有 1 个起始节点和 1 个结束节点，在起始节点和结束节点中形成链路。

![](https://pandora-kibana.qiniu.com/report/sankey_pattern2.png)

若数据出现有环情况，即数据由 A->B->A，在二级链路桑基图中表现为起始 A 和结束 A 是两个节点。如图：

![](https://pandora-kibana.qiniu.com/report/sankey_pattern2_spe.png)

上图通过桑基图分析不同城市间的人口迁徙情况，由于武汉市既有人口流入，又有人口流出，二级链路桑基图将其处理成两个节点。
# 多级链路桑基图
多级链路桑基图即广义中的桑基图，不限起始节点和结束节点数目，在各起始节点和结束节点中形成链路。

![](https://pandora-kibana.qiniu.com/report/sankey_multipattern.png)

一般的，广义链路桑基图用来展示无环数据，即数据中没有 A->B->A 行为。若数据出现有环情况，在多级链路桑基图中表现为起始 A 和结束 A 是一个节点。



