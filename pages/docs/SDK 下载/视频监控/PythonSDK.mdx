# **ç®€ä»‹**

æ­¤SDKä¸»è¦å¸®åŠ©æ‚¨å¿«é€Ÿæ¥å…¥ä¸ƒç‰›äº‘çš„è§†é¢‘ç›‘æ§å¹³å°ã€‚

ä¸»è¦æœ‰å¦‚ä¸‹åŠŸèƒ½ï¼š

- ç©ºé—´ç®¡ç†
- æµç®¡ç†
- è®¾å¤‡ç®¡ç†
- æ¨¡æ¿ç®¡ç†
- å½•åˆ¶ç®¡ç†

æ­¤ Python SDK é€‚ç”¨äº 2.7 å’Œ 3.3åŠä»¥ä¸Šç‰ˆæœ¬ã€‚

- [Python SDK ä¸‹è½½åœ°å€](https://github.com/qiniu/python-sdk/releases)
- [Python SDK æºç åœ°å€](https://github.com/qiniu/python-sdk)

<a id="install"></a>
# å®‰è£…

- ç›´æ¥å®‰è£…: 

```
pip install qiniu
æˆ–
easy_install qiniu
```

- æºç å®‰è£…ï¼š

```
#ä»Python SDK ä¸‹è½½åœ°å€ä¸‹è½½æºç 
tar xvzf python-sdk-$VERSION.tar.gz
cd python-sdk-$VERSION
python setup.py install
```

# **åˆå§‹åŒ–é‰´æƒ**

ä¸ƒç‰› Java SDK çš„æ‰€æœ‰çš„åŠŸèƒ½ï¼Œéƒ½éœ€è¦åˆæ³•çš„æˆæƒã€‚æˆæƒå‡­è¯çš„ç­¾ç®—éœ€è¦ä¸ƒç‰›è´¦å·ä¸‹çš„ä¸€å¯¹æœ‰æ•ˆçš„`Access Key`å’Œ`Secret Key`ï¼Œè¿™å¯¹å¯†é’¥å¯ä»¥é€šè¿‡å¦‚ä¸‹æ­¥éª¤è·å¾—ï¼š

1. ç‚¹å‡»[æ³¨å†Œ](https://portal.qiniu.com/signup)å¼€é€šä¸ƒç‰›å¼€å‘è€…å¸å·
2. å¦‚æœå·²æœ‰è´¦å·ï¼Œç›´æ¥ç™»å½•ä¸ƒç‰›å¼€å‘è€…åå°ï¼Œç‚¹å‡»[è¿™é‡ŒğŸ”—](https://portal.qiniu.com/user/key)æŸ¥çœ‹ Access Key å’Œ Secret Key

# **å‰ç½®è¯´æ˜**
1. QVSæ›´æ–°æ¥å£ä½¿ç”¨çš„æ˜¯patchè¯·æ±‚ï¼ŒSDKä¸­æœªæ·»åŠ è¯¥æ–¹æ³•ï¼Œå®¢æˆ·å¯ä»¥åœ¨python SDK  qiniu/http.py  æ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢è¿™ä¸ªæ–¹æ³•
```python
def _patch_with_qiniu_mac(url, data, auth):
    qn_auth = qiniu.auth.QiniuMacRequestsAuth(
        auth) if auth is not None else None
    timeout = config.get_default('connection_timeout')
    try:
        r = requests.patch(
            url,
            json=data,
            auth=qn_auth,
            timeout=timeout,
            headers=_headers)
    except Exception as e:
        return None, ResponseInfo(None, e)
    return __return_wrapper(r)
```
2. å®¢æˆ·å¯åœ¨python-sdk/qiniu/servicesç›®å½•ä¸‹åˆ›å»ºqvsçš„å­ç›®å½•ï¼Œåç»­çš„æ¥å£å‡½æ•°å…¨éƒ¨æ”¾ç½®åœ¨python-sdk/qiniu/services/qvså³å¯ã€‚

# **ç©ºé—´ç®¡ç†**

## **[åˆ›å»ºç©ºé—´](https://developer.qiniu.com/qvs/6726/create-namespace)**
### ç¤ºä¾‹
```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def createNamespaces(access_key, secret_key, body):
    """
    åˆ›å»ºç©ºé—´
    https://developer.qiniu.com/qvs/api/6726/create-namespace
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param body: è¯·æ±‚ä½“
        {
            "name": å¿…å¡«ï¼Œç©ºé—´åç§°(æ ¼å¼"^[a-zA-Z0-9_-]{1,100}$")
            "desc"ï¼šéå¿…å¡«ï¼Œç©ºé—´æè¿°
            "accessType": å¿…å¡«ï¼Œæ¥å…¥ç±»å‹(rtmpæˆ–è€…gb28181)
            "rtmpUrlType": accessTypeä¸ºâ€œrtmpâ€æ—¶ å¿…å¡«ï¼Œæ¨æ‹‰æµåœ°å€è®¡ç®—æ–¹å¼ï¼Œ1:static, 2:dynamic
            "domains": rtmpUrlTypeä¸º1æ—¶å¿…å¡«ï¼Œç›´æ’­åŸŸåï¼Œåˆ—è¡¨æ ¼å¼
            "callBack"ï¼šéå¿…å¡«ï¼Œå›è°ƒåœ°å€ï¼Œå¯ç”¨äºè·å–ç©ºé—´å†…è®¾å¤‡/æµçŠ¶æ€æ›´æ–°æ—¶çš„ä¿¡æ¯
            "recordTemplateId": éå¿…å¡«ï¼Œå½•åˆ¶æ¨¡ç‰ˆIDï¼Œéœ€è¦å½•åˆ¶åŠŸèƒ½æ—¶è¾“å…¥å¯¹åº”çš„æ¨¡æ¿IDï¼Œå½•åˆ¶æ¨¡æ¿IDå¯ä»¥æ¨¡æ¿ç®¡ç†ä¸­è·å–
            "snapshotTemplateId"ï¼šéå¿…å¡«ï¼Œæˆªå›¾æ¨¡ç‰ˆIDï¼Œéœ€è¦æˆªå›¾åŠŸèƒ½æ—¶è¾“å…¥å¯¹åº”çš„æ¨¡æ¿IDï¼Œæˆªå›¾æ¨¡æ¿IDå¯ä»¥æ¨¡æ¿ç®¡ç†ä¸­è·å–
            "recordTemplateApplyAll"ï¼šéå¿…å¡«ï¼Œç©ºé—´æ¨¡ç‰ˆæ˜¯å¦åº”ç”¨åˆ°å…¨å±€
            "snapshotTemplateApplyAll"ï¼šéå¿…å¡«ï¼Œæˆªå›¾æ¨¡ç‰ˆæ˜¯å¦åº”ç”¨åˆ°å…¨å±€
        }

    :return:
        {

        }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = "http://qvs.qiniuapi.com/v1/namespaces"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, body, auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'
    # è¯·æ±‚ä½“
    body = {
        "name": "test00",
        "accessType": "rtmp",
        "rtmpUrlType": 2,
        # "domains": ["tests6.com"],
        # "recordTemplateId": "xxxxxxxxxxx"
    }

    headers, result = createNamespaces(access_key, secret_key, body)
    print(f'{headers}\n{result}')
```
<br/>

## **[æŸ¥è¯¢ç©ºé—´](https://developer.qiniu.com/qvs/api/6729/query-namespace)**
### ç¤ºä¾‹

```python
// æŸ¥è¯¢ç©ºé—´
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def listNamespacesInfo(access_key, secret_key, namespaceId):
    """
    æŸ¥è¯¢ç©ºé—´ä¿¡æ¯
    https://developer.qiniu.com/qvs/api/6729/query-namespace
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # éœ€è¦æŸ¥è¯¢çš„ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    headers, result = listNamespacesInfo(access_key, secret_key, namespaceId)
    print(f'{headers}\n{result}')
```
<br/>

## **[æ›´æ–°ç©ºé—´](https://developer.qiniu.com/qvs/api/6728/update-namespace)**
### ç¤ºä¾‹
```python

# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def updateNamespaces(access_key, secret_key, namespaceId, body):
    """
    æ›´æ–°ç©ºé—´
    https://developer.qiniu.com/qvs/api/6728/update-namespace
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param body: è¯·æ±‚ä½“
            {
                "operations":[
                    {"key":"recordTemplateApplyAll", // è¦ä¿®æ”¹çš„å‚æ•°ï¼šname ç©ºé—´åç§°;desc ç©ºé—´æè¿°;callBack å›è°ƒåœ°å€;recordTemplateId å½•åˆ¶æ¨¡ç‰ˆID;snapshotTemplateId æˆªå›¾æ¨¡ç‰ˆID; recordTemplateApplyAll ç©ºé—´æ¨¡ç‰ˆæ˜¯å¦åº”ç”¨åˆ°å…¨å±€; snapshotTemplateApplyAll æˆªå›¾æ¨¡ç‰ˆæ˜¯å¦åº”ç”¨åˆ°å…¨å±€
                    "op":"replace", // opæ“ä½œ(ç›®å‰æ”¯æŒreplaceå’Œdelete)
                    "value":true}ï¼Œ // è¦ä¿®æ”¹çš„å‚æ•°å¯¹åº”çš„value(å½“opä¸ºdeleteçš„æ—¶å€™å¯ä»¥å¿½ç•¥)
                    { },
                    .....
            ]
            }
    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}"

    # å‘èµ·PATCHè¯·æ±‚
    ret, res = http._patch_with_qiniu_mac(url, body, auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # éœ€è¦æ›´æ–°çš„ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # è¯·æ±‚ä½“
    body = {
        "operations": [
            {"key": "name", "op": "replace", "value": ""xxxxxxxxxxx""}
        ]
    }

    headers, result = updateNamespaces(access_key, secret_key, namespaceId, body)
    print(f'{headers}\n{result}')
```

## **[è·å–ç©ºé—´åˆ—è¡¨](https://developer.qiniu.com/qvs/api/6730/list-namespace)**
### ç¤ºä¾‹
```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def listNamespaces(access_key, secret_key, offset=None, line=10, sortBy="desc:createdAt"):
    """
    è·å–ç©ºé—´åˆ—è¡¨
    https://developer.qiniu.com/qvs/api/6730/list-namespace
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param offset: åœ¨å…¨éƒ¨namespaceä¸­çš„åç§»é‡ï¼Œæ—¶é—´æˆ³
    :param line: ä¸€æ¬¡è¿”å›å¤šå°‘æ¡
    :param sortBy: asc è¡¨ç¤ºå‡åº, desc è¡¨ç¤ºé™åº, é»˜è®¤æŒ‰åˆ›å»ºæ—¶é—´é™åºæ’åˆ—(å¯å‚ä¸æ’åºçš„å­—æ®µæœ‰createdAt, updatedAt).asc:updatedAtè¡¨ç¤ºæ›´æ–°æ—¶é—´ä»å°åˆ°å¤§æ’åº, desc:updatedAtè¡¨ç¤ºæ›´æ–°æ—¶é—´ä»å¤§åˆ°å°æ’åº

    :return:
        200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)
    if offset is None:
        # è¯·æ±‚URL
        url = f"http://qvs.qiniuapi.com/v1/namespaces?line={line}&sortBy={sortBy}"
    else:
        url = f"http://qvs.qiniuapi.com/v1/namespaces?offset={offset}&line={line}&sortBy={sortBy}"
    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    headers, result = listNamespaces(access_key, secret_key)
    print(f'{headers}\n{result}') 
```

## **[ç¦ç”¨ç©ºé—´](https://developer.qiniu.com/qvs/api/6759/disable-the-space)**
### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def disableNamespaces(access_key, secret_key, namespaceId):
    """
    ç¦ç”¨ç©ºé—´
    https://developer.qiniu.com/qvs/api/6759/disable-the-space
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/disabled"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # éœ€è¦æŸ¥è¯¢çš„ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    headers, result = disableNamespaces(access_key, secret_key, namespaceId)
    print(f'{headers}\n{result}')

```

## **[å¯ç”¨ç©ºé—´](https://developer.qiniu.com/qvs/api/6760/enable-the-space)**
### ç¤ºä¾‹
```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def disableNamespaces(access_key, secret_key, namespaceId):
    """
    å¯ç”¨ç©ºé—´
    https://developer.qiniu.com/qvs/api/6760/enable-the-space
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/enabled"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # éœ€è¦æŸ¥è¯¢çš„ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    headers, result = disableNamespaces(access_key, secret_key, namespaceId)
    print(f'{headers}\n{result}')
```


## **[åˆ é™¤ç©ºé—´](https://developer.qiniu.com/qvs/api/6727/delete-namespace)**

### ç¤ºä¾‹

```python

# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def deleteNamespaces(access_key, secret_key, namespaceId):
    """
    åˆ é™¤ç©ºé—´
    https://developer.qiniu.com/qvs/api/6727/delete-namespace
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._delete_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # éœ€è¦åˆ é™¤çš„ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    headers, result = deleteNamespaces(access_key, secret_key, namespaceId)
    print(f'{headers}\n{result}')
```

# **æµç®¡ç†**


## **[åˆ›å»ºæµ](https://developer.qiniu.com/qvs/api/6734/create-flow)**
æœ¬æ¥å£ä»…ç”¨äºæ¥å…¥ç±»å‹ä¸ºRTMPçš„ç©ºé—´
### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def createStreams(access_key, secret_key, namespaceId, body):
    """
    åˆ›å»ºæµ
    https://developer.qiniu.com/qvs/api/6734/create-flow
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param bodyï¼š è¯·æ±‚ä½“
            {
                "streamId":"device009", // å¿…å¡«ï¼Œæµåç§°, æµåç§°åœ¨ç©ºé—´ä¸­å”¯ä¸€ï¼Œå¯åŒ…å« å­—æ¯ã€æ•°å­—ã€ä¸­åˆ’çº¿ã€ä¸‹åˆ’çº¿ï¼›1 ~ 100 ä¸ªå­—ç¬¦é•¿ï¼›åˆ›å»ºåå°†ä¸å¯ä¿®æ”¹
                "desc":"æµè¯´æ˜ä¿¡æ¯", // éå¿…å¡«ï¼Œå…³äºæµçš„æè¿°ä¿¡æ¯
                "recordTemplateId":"d102sns2mwhd", // éå¿…å¡«ï¼Œå½•åˆ¶æ¨¡ç‰ˆIDï¼Œé…ç½®æµç»´åº¦çš„å½•åˆ¶æ¨¡æ¿
                "snapshotTemplateId":"æˆªå›¾æ¨¡æ¿ID" // éå¿…å¡«ï¼Œæˆªå›¾æ¨¡ç‰ˆIDï¼Œé…ç½®æµç»´åº¦çš„æˆªå›¾æ¨¡æ¿
            }

    :return:
           200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, body, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # éœ€è¦æŸ¥è¯¢çš„ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # è¯·æ±‚ä½“
    body = {
        "streamId": "xxxxxxxxxxx",
        "desc": "åˆ›å»ºæµæµ‹è¯•",
        # "recordTemplateId": "xxxxxxxxxxx"
    }

    headers, result = createStreams(access_key, secret_key, namespaceId, body)
    print(f'{headers}\n{result}')
```


## **[æŸ¥è¯¢æµ](https://developer.qiniu.com/qvs/api/6736/query-information-flow)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def streamsInfo(access_key, secret_key, namespaceId, streamId):
    """
    æŸ¥è¯¢æµä¿¡æ¯
    https://developer.qiniu.com/qvs/api/6736/query-information-flow
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param streamId: æµåID

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}"

    # å‘èµ·GETè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # éœ€è¦æŸ¥è¯¢çš„ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # æµåID
    streamId = "xxxxxxxxxxx"

    headers, result = streamsInfo(access_key, secret_key, namespaceId, streamId)
    print(f'{headers}\n{result}')
```


## **[æ›´æ–°æµ](https://developer.qiniu.com/qvs/api/6758/update-the-flow)**


### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def updateStreams(access_key, secret_key, namespaceId, streamId, body):
    """
    æ›´æ–°æµ
    https://developer.qiniu.com/qvs/api/6758/update-the-flow
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param streamId: æµåID
    :param body: è¯·æ±‚ä½“
                {
                    "operations":[
                        {"key":"desc", //  å¿…å¡«ï¼Œè¦ä¿®æ”¹çš„å‚æ•°ï¼šdesc æµæè¿°;recordTemplateId å½•åˆ¶æ¨¡ç‰ˆID;snapshotTemplateId æˆªå›¾æ¨¡ç‰ˆID; disabled æµæ˜¯å¦è¢«ç¦ç”¨
                        "op":"replace", // å¿…å¡«ï¼Œopæ“ä½œ(ç›®å‰æ”¯æŒreplaceå’Œdelete)
                        "value":true}ï¼Œ // å¿…å¡«ï¼Œè¦ä¿®æ”¹çš„å‚æ•°å¯¹åº”çš„value(å½“opä¸ºdeleteçš„æ—¶å€™å¯ä»¥å¿½ç•¥)
                        { },
                        .....
                ]
                }

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}"

    # å‘èµ·PATCHè¯·æ±‚
    ret, res = http._patch_with_qiniu_mac(url, body, auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # éœ€è¦æŸ¥è¯¢çš„ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # æµåID
    streamId = "xxxxxxxxxxx"

    # è¯·æ±‚ä½“
    body = {
        "operations": [
            {"key": "desc", "op": "replace", "value": "ceshi121212"}
        ]
    }

    headers, result = updateStreams(access_key, secret_key, namespaceId, streamId, body)
    print(f'{headers}\n{result}')
```


## **[è·å–æµåˆ—è¡¨](https://developer.qiniu.com/qvs/api/6737/query-list-flow)**


### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def listStreams(access_key, secret_key, namespaceid, offset=None, line=10, qtype=0, prefix=None,
                sortBy="desc:createdAt"):
    """
    è·å–æµåˆ—è¡¨
    https://developer.qiniu.com/qvs/api/6737/query-list-flow
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceid: ç©ºé—´åç§°ID
    :param offset: åœ¨å…¨éƒ¨namespaceä¸­çš„åç§»é‡ï¼Œæ—¶é—´æˆ³
    :param line: ä¸€æ¬¡è¿”å›å¤šå°‘æ¡
    :param qtype: æŸ¥è¯¢æµç±»å‹ï¼Œ 0:å…¨éƒ¨,1:åœ¨çº¿æµ,2:ç¦»çº¿æµ
    :param prefix: æµID å‰ç¼€ï¼Œå¯ä»¥æµID å‰ç¼€è¿›è¡Œæ£€ç´¢æŸ¥è¯¢
    :param sortBy: asc è¡¨ç¤ºå‡åº, desc è¡¨ç¤ºé™åº, é»˜è®¤æŒ‰åˆ›å»ºæ—¶é—´é™åºæ’åˆ—(å¯å‚ä¸æ’åºçš„å­—æ®µæœ‰createdAt, updatedAt).asc:updatedAtè¡¨ç¤ºæ›´æ–°æ—¶é—´ä»å°åˆ°å¤§æ’åº, desc:updatedAtè¡¨ç¤ºæ›´æ–°æ—¶é—´ä»å¤§åˆ°å°æ’åº

    :return:
        200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)
    if offset is None and prefix is None:
        # è¯·æ±‚URL
        url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceid}/streams?line={line}&sortBy={sortBy}&qtype={qtype}"
    else:
        url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceid}/streams?offset={offset}&line={line}&qtype={qtype}&prefix={prefix}&sortBy={sortBy}"
    # å‘èµ·GETè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceid = "xxxxxxxxxxx"

    headers, result = listStreams(access_key, secret_key, namespaceid, )
    print(f'{headers}\n{result}')
```

## **[è·å–æµåœ°å€](https://developer.qiniu.com/qvs/api/6740/obtain-flow-address)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def staticStreamDomain(access_key, secret_key, namespaceid, streamid, body):
    """
    é™æ€æ¨¡å¼æµåœ°å€
    https://developer.qiniu.com/qvs/api/6800/static-model
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceid: ç©ºé—´åç§°ID
    :param streamid: æµID
    :param body: è¯·æ±‚ä½“
            {
                "domain": "qvs-live-hdl.qiniu.com", // å¿…å¡«ï¼ŒåŸŸå
                "domainType": "liveHdl", // å¿…å¡«ï¼ŒåŸŸåç±»å‹,å–å€¼ï¼š"publishRtmp":rtmpæ¨æµ, "liveRtmp": rtmpæ’­æ”¾, "liveHls": hlsæ’­æ”¾, "liveHdl": flvæ’­æ”¾
                "urlExpireSec": // éå¿…å¡«ï¼Œæ¨æµåœ°å€è¿‡æœŸæ—¶é—´(å•ä½ä¸ºç§’)
            }
    :return:
        200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceid}/streams/{streamid}/domain"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, body, auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


def dynamicStreamDomain(access_key, secret_key, namespaceid, streamid, body):
    """
    åŠ¨æ€æ¨¡å¼æµåœ°å€
    https://developer.qiniu.com/qvs/api/6801/dynamic-model
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceid: ç©ºé—´åç§°ID
    :param streamid: æµID
    :param body: è¯·æ±‚ä½“
            {
                "publishIp": "", // éå¿…å¡«ï¼Œæ¨æµç«¯å¯¹å¤–IPåœ°å€
                "playIp": "", // éå¿…å¡«ï¼Œæ‹‰æµç«¯å¯¹å¤–IPåœ°å€
                "urlExpireSec": // éå¿…å¡«ï¼Œæ¨æµåœ°å€è¿‡æœŸæ—¶é—´(å•ä½ä¸ºç§’)
            }
    :return:
        200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceid}/streams/{streamid}/urls"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, body, auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceid = "xxxxxxxxxxx"

    #  æµID
    streamid = "xxxxxxxxxxx"

    """é™æ€æ¨¡å¼è¯·æ±‚ä½“"""
    # # è¯·æ±‚ä½“
    # body = {
    #     "domain": ""xxxxxxxxxxx"",
    #     "domainType": "publishRtmp"
    # }
    #
    # headers, result = staticStreamDomain(access_key, secret_key, namespaceid, streamid, body)
    # print(f'{headers}\n{result}')

    """åŠ¨æ€æ¨¡å¼è¯·æ±‚ä½“"""
    # è¯·æ±‚ä½“
    body = {
        "publishIp": ""xxxxxxxxxxx"",
        "playIp": "publishRtmp"
    }

    headers, result = dynamicStreamDomain(access_key, secret_key, namespaceid, streamid, body)
    print(f'{headers}\n{result}')
```



## **[æŸ¥è¯¢æ¨æµå†å²è®°å½•](https://developer.qiniu.com/qvs/api/6742/query-flow-records)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json, time


# æ—¥æœŸè½¬æ—¶é—´æˆ³
def time2timestamp(datetime):
    # è½¬ä¸ºæ—¶é—´æ•°ç»„
    timeArray = time.strptime(datetime, "%Y-%m-%d %H:%M:%S")
    timeStamp = int(time.mktime(timeArray))
    return timeStamp


def listNamespaces(access_key, secret_key, namespaceId, streamId, startDate, endDate, offset=None, line=10):
    """
    è·å–æ¨æµè®°å½•
    https://developer.qiniu.com/qvs/api/6742/query-flow-records
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param offset: éå¿…å¡«ï¼Œåœ¨å…¨éƒ¨namespaceä¸­çš„åç§»é‡ï¼Œæ—¶é—´æˆ³
    :param line: éå¿…å¡«ï¼Œä¸€æ¬¡è¿”å›å¤šå°‘æ¡
    :param start: å¿…å¡«ï¼Œæ¨æµå¼€å§‹æ—¶é—´(unix timestamp in second)
    :param end: å¿…å¡«ï¼Œæ¨æµç»“æŸæ—¶é—´(unix timestamp in second)

    :return:
        200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    start = time2timestamp(startDate)

    end = time2timestamp(endDate)

    if offset is None:
        # è¯·æ±‚URL
        url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}/pubhistories?start={start}&end={end}&line={line}"
    else:
        url = f"http://qvs.qiniuapi.com/v1/namespaces?start={start}&end={end}&line={line}&offset={offset}"
    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # æµID
    streamId = "xxxxxxxxxxx"

    # æ¨æµå¼€å§‹æ—¶é—´ï¼ˆUnix æ—¶é—´æˆ³ï¼‰
    startDate = "2020-06-08 00:00:00"

    # æ¨æµç»“æŸæ—¶é—´ï¼ˆUnix æ—¶é—´æˆ³ï¼‰
    endDate = "2020-06-09 00:00:00"

    headers, result = listNamespaces(access_key, secret_key, namespaceId, streamId, startDate, endDate)
    print(f'{headers}\n{result}')
```

## **[ç¦ç”¨æµ](https://developer.qiniu.com/qvs/api/6738/disable-the-flow)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def disableStreams(access_key, secret_key, namespaceId, streamId):
    """
    ç¦ç”¨æµ
    https://developer.qiniu.com/qvs/api/6738/disable-the-flow
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param streamId: æµID

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}/disabled"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # æµID
    streamId = "xxxxxxxxxxx"

    headers, result = disableStreams(access_key, secret_key, namespaceId, streamId)
    print(f'{headers}\n{result}')
```


## **[å¯ç”¨æµ](https://developer.qiniu.com/qvs/api/6739/enable-the-flow)**



### ç¤ºä¾‹

```python
// å¯ç”¨æµ
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def enableStreams(access_key, secret_key, namespaceId, streamId):
    """
    å¯ç”¨æµ
    https://developer.qiniu.com/qvs/api/6739/enable-the-flow
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param streamId: æµID

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}/enabled"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # æµID
    streamId = "xxxxxxxxxxx"

    headers, result = enableStreams(access_key, secret_key, namespaceId, streamId)
    print(f'{headers}\n{result}')
```
## **[åˆ é™¤æµ](https://developer.qiniu.com/qvs/api/6735/delete-flow)**


### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def deleteStreams(access_key, secret_key, namespaceId, streamId):
    """
    åˆ é™¤æµ
    https://developer.qiniu.com/qvs/api/6735/delete-flow
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param streamId: æµåID

    :return:
           200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._delete_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # éœ€è¦æŸ¥è¯¢çš„ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # æµåID
    streamId = "xxxxxxxxxxx"

    headers, result = deleteStreams(access_key, secret_key, namespaceId, streamId)
    print(f'{headers}\n{result}')
```

## **[åœç”¨æµ](https://developer.qiniu.com/qvs/api/6849/stop-using-flow)**
ä»…é€‚ç”¨äº`rtmp`ç±»å‹çš„ç©ºé—´ï¼Œç”¨æˆ·ä¸»åŠ¨æ–­å¼€æ¨æµã€‚


### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def stopStreams(access_key, secret_key, namespaceId, streamId):
    """
    åœæ­¢æ¨æµ
    https://developer.qiniu.com/qvs/api/6849/stop-using-flow
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param streamId: æµID

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}/stop"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # æµID
    streamId = "xxxxxxxxxxx"

    headers, result = stopStreams(access_key, secret_key, namespaceId, streamId)
    print(f'{headers}\n{result}')

```

# **è®¾å¤‡ç®¡ç†**

## **[åˆ›å»ºè®¾å¤‡](https://developer.qiniu.com/qvs/api/6896/create-device)**

### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http, urlsafe_base64_encode
import json


def createNamespaces(access_key, secret_key, namespaceId, body):
    """
    åˆ›å»ºè®¾å¤‡
    https://developer.qiniu.com/qvs/api/6896/create-device
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param body: è¯·æ±‚ä½“
        {
            "name": éå¿…å¡«ï¼Œè®¾å¤‡åç§°ï¼ˆå¯åŒ…å« å­—æ¯ã€æ•°å­—ã€ä¸­åˆ’çº¿ã€ä¸‹åˆ’çº¿ï¼›1 ~ 100 ä¸ªå­—ç¬¦é•¿ï¼‰
            "gbId"ï¼šéå¿…å¡«ï¼Œè®¾å¤‡å›½æ ‡ID è¦æ±‚å…¨å±€å”¯ä¸€, è¯¥å­—æ®µä¸ºç©ºæ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºgbid
            "username": éå¿…å¡«ï¼Œç”¨æˆ·å, 4~40ä½ï¼Œå¯åŒ…å«å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ã€ä¸­åˆ’çº¿ã€‚å½“è¯¥å­—æ®µä¸ºç©ºæ—¶,é»˜è®¤å€¼å°±æ˜¯è®¾å¤‡å›½æ ‡ID
            "password": å¿…å¡«ï¼Œå¯†ç , 4~40ä½ï¼Œå¯åŒ…å«å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ã€ä¸­åˆ’çº¿
            "pullIfRegister": éå¿…å¡«ï¼Œæ³¨å†ŒæˆåŠŸåå¯åŠ¨æ‹‰æµ, é»˜è®¤å…³é—­
            "desc"ï¼šéå¿…å¡«ï¼Œå…³äºè®¾å¤‡çš„æè¿°ä¿¡æ¯
        }

    :return:
        {

        }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/devices"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, body, auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # è¯·æ±‚ä½“
    body = {
        "name": "device1",
        "desc": "test gb28181",
        "username": "username",
        "password": "password"
    }

    headers, result = createNamespaces(access_key, secret_key, namespaceId, body)
    print(f'{headers}\n{result}')

```


## **[åˆ é™¤è®¾å¤‡](https://developer.qiniu.com/qvs/api/6898/Delete-device)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def deleteNamespaces(access_key, secret_key, namespaceId, gbId):
    """
    åˆ é™¤è®¾å¤‡
    https://developer.qiniu.com/qvs/api/6898/Delete-device
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param gbId: è®¾å¤‡å›½æ ‡Id
    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/devices/{gbId}"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._delete_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # è®¾å¤‡å›½æ ‡Id
    gbId = "xxxxxxxxxxx"

    headers, result = deleteNamespaces(access_key, secret_key, namespaceId, gbId)
    print(f'{headers}\n{result}')
```

## **[æŸ¥è¯¢è®¾å¤‡](https://developer.qiniu.com/qvs/api/6901/Query-device-information)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def listNamespacesInfo(access_key, secret_key, namespaceId, gbId):
    """
    æŸ¥è¯¢è®¾å¤‡ä¿¡æ¯
	https://developer.qiniu.com/qvs/api/6901/Query-device-information
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param gbId: è®¾å¤‡å›½æ ‡Id
    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/devices/{gbId}"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # è®¾å¤‡å›½æ ‡Id
    gbId = "xxxxxxxxxxx"

    headers, result = listNamespacesInfo(access_key, secret_key, namespaceId, gbId)
    print(f'{headers}\n{result}')
```

## **æ›´æ–°è®¾å¤‡[é“¾æ¥](https://developer.qiniu.com/qvs/api/6899/update-the-device)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def updateNamespaces(access_key, secret_key, namespaceId, gbId, body):
    """
    æ›´æ–°è®¾å¤‡
    https://developer.qiniu.com/qvs/api/6899/update-the-device
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param gbId: è®¾å¤‡å›½æ ‡Id
    :param body: è¯·æ±‚ä½“
            {
                "operations":[
                    {"key":"desc", // è¦ä¿®æ”¹çš„å‚æ•°ï¼šname è®¾å¤‡åç§°;desc è®¾å¤‡æè¿°;gbId è®¾å¤‡å›½æ ‡ID;username ç”¨æˆ·å;password å¯†ç ; pullIfRegister æ³¨å†ŒæˆåŠŸåå¯åŠ¨æ‹‰æµ
                    "op":"replace", // opæ“ä½œ(ç›®å‰æ”¯æŒreplaceå’Œdelete)
                    "value":gb patch test}ï¼Œ // è¦ä¿®æ”¹çš„å‚æ•°å¯¹åº”çš„value(å½“opä¸ºdeleteçš„æ—¶å€™å¯ä»¥å¿½ç•¥)
                    { },
                    .....
            ]
            }
    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/devices/{gbId}"

    # å‘èµ·PATCHè¯·æ±‚
    ret, res = http._patch_with_qiniu_mac(url, body, auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # è®¾å¤‡å›½æ ‡Id
    gbId = "xxxxxxxxxxx"

    # è¯·æ±‚ä½“
    body = {
        "operations": [
            {"key": "desc",
             "op": "replace",
             "value": "gb patch test"}
        ]
    }

    headers, result = updateNamespaces(access_key, secret_key, namespaceId, gbId, body)
    print(f'{headers}\n{result}')
```
<br/>

## **[è·å–è®¾å¤‡åˆ—è¡¨](https://developer.qiniu.com/qvs/api/6902/Query-device-list)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def listNamespaces(access_key, secret_key, namespaceId, offset=0, line=10, prefix=None, state="notReg",
                   qtype=0):
    """
    è·å–è®¾å¤‡åˆ—è¡¨
    https://developer.qiniu.com/qvs/api/6902/Query-device-list
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param offset: åœ¨å…¨éƒ¨namespaceä¸­çš„åç§»é‡ï¼Œinteger
    :param line: ä¸€æ¬¡è¿”å›å¤šå°‘æ¡
    :param prefix: å¯ä»¥é€šè¿‡gbidå‰ç¼€è¿›è¡Œæ£€ç´¢æŸ¥è¯¢
    :param state: æŒ‰è®¾å¤‡çŠ¶æ€æŸ¥è¯¢ï¼Œoffline: ç¦»çº¿, online: åœ¨çº¿, notReg: æœªæ³¨å†Œ, locked: é”å®š
    :param qtype: æŒ‰è®¾å¤‡ç±»å‹æŸ¥è¯¢ï¼Œ0:å…¨éƒ¨, 1:æ‘„åƒå¤´, 2:å¹³å°

    :return:
        200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/devices?offset={offset}&line={line}&prefix={prefix}&state={state}&qtype={qtype}"
    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    headers, result = listNamespaces(access_key, secret_key, namespaceId)
    print(f'{headers}\n{result}')
```


## **[è·å–é€šé“åˆ—è¡¨](https://developer.qiniu.com/qvs/api/6906/query-channel-list)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def listNamespaces(access_key, secret_key, namespaceId, gbId, prefix=None):
    """
    è·å–é€šé“åˆ—è¡¨
    https://developer.qiniu.com/qvs/api/6906/query-channel-list
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param gbId: è®¾å¤‡å›½æ ‡Id
    :param prefix: é€šé“å›½æ ‡IDå‰ç¼€

    :return:
        200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/devices/{gbId}/channels?prefix={prefix}"
    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # è®¾å¤‡å›½æ ‡Id
    gbId = "xxxxxxxxxxx"

    headers, result = listNamespaces(access_key, secret_key, namespaceId, gbId)
    print(f'{headers}\n{result}')
```
<br/>

## **[å¯åŠ¨è®¾å¤‡æ‹‰æµ](https://developer.qiniu.com/qvs/api/6907/start-device)**


### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def startDevice(access_key, secret_key, namespaceId, gbId):
    """
    å¯åŠ¨è®¾å¤‡æ‹‰æµ
    https://developer.qiniu.com/qvs/api/6907/start-device
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param gbId: è®¾å¤‡å›½æ ‡Id

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/devices/{gbId}/start"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # è®¾å¤‡å›½æ ‡Id
    gbId = "xxxxxxxxxxx"

    headers, result = startDevice(access_key, secret_key, namespaceId, gbId)
    print(f'{headers}\n{result}')
```

## **[åœæ­¢è®¾å¤‡æ‹‰æµ](https://developer.qiniu.com/qvs/api/6908/stop-device)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def stopDevice(access_key, secret_key, namespaceId, gbId):
    """
    åœæ­¢è®¾å¤‡æ‹‰æµ
    https://developer.qiniu.com/qvs/api/6908/stop-device
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: ç©ºé—´ID
    :param gbId: è®¾å¤‡å›½æ ‡Id

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/devices/{gbId}/stop"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
   	# ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # è®¾å¤‡å›½æ ‡Id
    gbId = "xxxxxxxxxxx"

    headers, result = stopDevice(access_key, secret_key, namespaceId, gbId)
    print(f'{headers}\n{result}')

```



# **æ¨¡æ¿ç®¡ç†**

## **[åˆ›å»ºæ¨¡æ¿](https://developer.qiniu.com/qvs/api/6721/create-template)**
	
### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http, urlsafe_base64_encode
import json


def createTemplate(access_key, secret_key, body):
    """
    åˆ›å»ºæ¨¡æ¿
    https://developer.qiniu.com/qvs/api/6721/create-template
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param body: è¯·æ±‚ä½“
        {
            "name": å¿…å¡«ï¼Œæ¨¡ç‰ˆåç§°ï¼Œæ ¼å¼ä¸º 1 ~ 100ä¸ªå­—ç¬¦ï¼Œå¯åŒ…å«å°å†™å­—æ¯ã€æ•°å­—ã€ä¸­åˆ’çº¿
            "desc"ï¼šéå¿…å¡«ï¼Œæ¨¡æ¿æè¿°
            "bucket": å¿…å¡«ï¼Œæ¨¡ç‰ˆå¯¹åº”çš„å¯¹è±¡å­˜å‚¨çš„bucket
            "deleteAfterDays": å¿…å¡«ï¼Œå­˜å‚¨è¿‡æœŸæ—¶é—´,é»˜è®¤æ°¸ä¹…ä¸è¿‡æœŸ
            "fileType": å¿…å¡«ï¼Œæ–‡ä»¶å­˜å‚¨ç±»å‹,å–å€¼ï¼š0ï¼ˆæ™®é€šå­˜å‚¨ï¼‰,1ï¼ˆä½é¢‘å­˜å‚¨ï¼‰
            "recordFileFormat": éå¿…å¡«ï¼Œå½•åˆ¶æ–‡ä»¶å­˜å‚¨æ ¼å¼,å–å€¼ï¼š0ï¼ˆm3u8æ ¼å¼å­˜å‚¨ï¼‰
            "templateType": å¿…å¡«ï¼Œæ¨¡æ¿ç±»å‹,å–å€¼ï¼š0ï¼ˆå½•åˆ¶æ¨¡ç‰ˆï¼‰, 1ï¼ˆæˆªå›¾æ¨¡ç‰ˆï¼‰
            "recordType"ï¼štemplateTypeä¸º0æ—¶é¡»æŒ‡å®šï¼Œå½•åˆ¶æ¨¡å¼, 0ï¼ˆä¸å½•åˆ¶ï¼‰,1ï¼ˆå®æ—¶å½•åˆ¶ï¼‰2 (æŒ‰éœ€å½•åˆ¶)
            "jpgOverwriteStatus": templateTypeä¸º1æ—¶é¡»æŒ‡å®šï¼Œå¼€å¯è¦†ç›–å¼æˆªå›¾(ä¸€èˆ¬ç”¨äºæµå°é¢)
            "jpgSequenceStatus"ï¼štemplateTypeä¸º1æ—¶é¡»æŒ‡å®šï¼Œå¼€å¯åºåˆ—å¼æˆªå›¾
            "jpgOnDemandStatus"ï¼štemplateTypeä¸º1æ—¶é¡»æŒ‡å®šï¼Œå¼€å¯æŒ‰éœ€æˆªå›¾
            "recordInterval"ï¼šéå¿…å¡«ï¼Œå½•åˆ¶æ–‡ä»¶æ—¶é•¿ å•ä½ä¸ºç§’,600~3600
            "snapInterval": éå¿…å¡«ï¼Œæˆªå›¾é—´éš”, å•ä½ä¸ºç§’, 10~600
        }

    :return:
        {

        }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = "http://qvs.qiniuapi.com/v1/templates"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._post_with_qiniu_mac(url, body, auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # è¯·æ±‚ä½“
    body = {
        "name": "test0013",
        "desc": "this is a test",
        "delateAfterDays": 7,
        "interval": 5,
        "templateType": 1,
        "bucket": "xxxxxxxxxxx",
        "jpgOverwriteStatus": True,
        "jpgSequenceStatus": True,
        "jpgOnDemandStatus": True
    }

    headers, result = createTemplate(access_key, secret_key, body)
    print(f'{headers}\n{result}')
```
<br/>

## **[æŸ¥è¯¢æ¨¡æ¿](https://developer.qiniu.com/qvs/api/6724/template-information)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def listNamespacesInfo(access_key, secret_key, templateId):
    """
    æŸ¥è¯¢æ¨¡æ¿ä¿¡æ¯
    https://developer.qiniu.com/qvs/api/6724/template-information
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param templateId: æ¨¡æ¿ID

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/templates/{templateId}"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # æ¨¡æ¿ID
    templateId = "xxxxxxxxxxx"

    headers, result = listNamespacesInfo(access_key, secret_key, templateId)
    print(f'{headers}\n{result}')
```


## **[æ›´æ–°æ¨¡æ¿](https://developer.qiniu.com/qvs/api/6723/modify-the-template)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def updateTemplate(access_key, secret_key, templateId, body):
    """
    æ›´æ–°æ¨¡æ¿
    https://developer.qiniu.com/qvs/api/6723/modify-the-template
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param templateId: æ¨¡æ¿ID
    :param body: è¯·æ±‚ä½“
            {
                "operations":[
                    {"key":"recordTemplateApplyAll", // è¦ä¿®æ”¹çš„å‚æ•°ï¼šname æ¨¡æ¿åç§°;desc æ¨¡æ¿æè¿°;bucket æ¨¡ç‰ˆå¯¹åº”çš„å¯¹è±¡å­˜å‚¨çš„bucket;deleteAfterDays å­˜å‚¨è¿‡æœŸæ—¶é—´,é»˜è®¤æ°¸ä¹…ä¸è¿‡æœŸ;fileType æ–‡ä»¶å­˜å‚¨ç±»å‹,å–å€¼ï¼š0ï¼ˆæ™®é€šå­˜å‚¨ï¼‰,1ï¼ˆä½é¢‘å­˜å‚¨ï¼‰; recordType å½•åˆ¶æ¨¡å¼, 0ï¼ˆä¸å½•åˆ¶ï¼‰,1ï¼ˆå®æ—¶å½•åˆ¶ï¼‰; jpgOverwriteStatus å¼€å¯è¦†ç›–å¼æˆªå›¾(ä¸€èˆ¬ç”¨äºæµå°é¢); recordInterval å½•åˆ¶æ–‡ä»¶æ—¶é•¿ å•ä½ä¸ºç§’, 600~3600; snapInterval æˆªå›¾é—´éš”, å•ä½ä¸ºç§’, 10~600; jpgSequenceStatus å¼€å¯åºåˆ—å¼æˆªå›¾
                    "op":"replace", // opæ“ä½œ(ç›®å‰æ”¯æŒreplaceå’Œdelete)
                    "value":true}ï¼Œ // è¦ä¿®æ”¹çš„å‚æ•°å¯¹åº”çš„value(å½“opä¸ºdeleteçš„æ—¶å€™å¯ä»¥å¿½ç•¥)
                    { },
                    .....
            ]
            }
    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/templates/{templateId}"

    # å‘èµ·PATCHè¯·æ±‚
    ret, res = http._patch_with_qiniu_mac(url, body, auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # æ¨¡æ¿ID
    templateId = "xxxxxxxxxxx"

    # è¯·æ±‚ä½“
    body = {
        "operations": [
            {"key": "deleteAfterDays", "op": "replace", "value": 0}
        ]
    }

    headers, result = updateTemplate(access_key, secret_key, templateId, body)
    print(f'{headers}\n{result}')
```


## **[è·å–æ¨¡æ¿åˆ—è¡¨](https://developer.qiniu.com/qvs/api/6725/list-template)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def listTemplates(access_key, secret_key, offset=None, templateType=None, match=None, line=10,
                  sortBy="desc:createdAt"):
    """
    è·å–æ¨¡æ¿åˆ—è¡¨
    https://developer.qiniu.com/qvs/api/6725/list-template
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param offset: éå¿…å¡«ï¼Œåœ¨å…¨éƒ¨namespaceä¸­çš„åç§»é‡ï¼Œæ—¶é—´æˆ³
    :param line: éå¿…å¡«ï¼Œä¸€æ¬¡è¿”å›å¤šå°‘æ¡
    :param sortBy: éå¿…å¡«ï¼Œasc è¡¨ç¤ºå‡åº, desc è¡¨ç¤ºé™åº, é»˜è®¤æŒ‰åˆ›å»ºæ—¶é—´é™åºæ’åˆ—(å¯å‚ä¸æ’åºçš„å­—æ®µæœ‰createdAt, updatedAt).asc:updatedAtè¡¨ç¤ºæ›´æ–°æ—¶é—´ä»å°åˆ°å¤§æ’åº, desc:updatedAtè¡¨ç¤ºæ›´æ–°æ—¶é—´ä»å¤§åˆ°å°æ’åº
    :param templateType: éå¿…å¡«ï¼Œæ¨¡æ¿ç±»å‹ï¼Œå–å€¼ï¼š0ï¼ˆå½•åˆ¶æ¨¡ç‰ˆï¼‰, 1ï¼ˆæˆªå›¾æ¨¡ç‰ˆï¼‰
    :param match: éå¿…å¡«ï¼Œæ¨¡ç³ŠåŒ¹é…æŸ¥è¯¢(æ¨¡ç‰ˆåç§°åŒ…å«matchä¸²æ—¶è¿”å›)

    :return:
        200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)
    if offset is None and match is None and templateType is None:
        # è¯·æ±‚URL
        url = f"http://qvs.qiniuapi.com/v1/templates?line={line}&sortBy={sortBy}"
    else:
        url = f"http://qvs.qiniuapi.com/v1/templates?offset={offset}&line={line}&sortBy={sortBy}&templateType={templateType}&match={match}"
    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    headers, result = listTemplates(access_key, secret_key)
    print(f'{headers}\n{result}')
```
<br/>

## **[åˆ é™¤æ¨¡æ¿](https://developer.qiniu.com/qvs/api/6722/delete-template)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json


def deleteTemplate(access_key, secret_key, templateId):
    """
    åˆ é™¤æ¨¡æ¿
    https://developer.qiniu.com/qvs/api/6722/delete-template
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param templateId: æ¨¡æ¿ID

    :return:
            {
                "code": 200
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/templates/{templateId}"

    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._delete_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result


if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # æ¨¡æ¿ID
    templateId = "xxxxxxxxxxx"

    headers, result = deleteTemplate(access_key, secret_key, templateId)
    print(f'{headers}\n{result}')
```

# **å½•åˆ¶ç®¡ç†**

## **[æŸ¥è¯¢äº‘ç«¯å½•åˆ¶è®°å½•](https://developer.qiniu.com/qvs/api/6745/query-recordhistories)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json, time


# æ—¥æœŸè½¬æ—¶é—´æˆ³
def time2timestamp(datetime):
    # è½¬ä¸ºæ—¶é—´æ•°ç»„
    timeArray = time.strptime(datetime, "%Y-%m-%d %H:%M:%S")
    timeStamp = int(time.mktime(timeArray))
    return timeStamp


def recordHistories(access_key, secret_key, namespaceId, streamId, start, end, line=10, marker=None):
    """
    æŸ¥è¯¢å½•åˆ¶è®°å½•
    https://developer.qiniu.com/qvs/api/6745/query-recordhistories
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param offset: éå¿…å¡«ï¼Œåœ¨å…¨éƒ¨namespaceä¸­çš„åç§»é‡ï¼Œæ—¶é—´æˆ³
    :param line: éå¿…å¡«ï¼Œä¸€æ¬¡è¿”å›å¤šå°‘æ¡
    :param sortBy: éå¿…å¡«ï¼Œasc è¡¨ç¤ºå‡åº, desc è¡¨ç¤ºé™åº, é»˜è®¤æŒ‰åˆ›å»ºæ—¶é—´é™åºæ’åˆ—(å¯å‚ä¸æ’åºçš„å­—æ®µæœ‰createdAt, updatedAt).asc:updatedAtè¡¨ç¤ºæ›´æ–°æ—¶é—´ä»å°åˆ°å¤§æ’åº, desc:updatedAtè¡¨ç¤ºæ›´æ–°æ—¶é—´ä»å¤§åˆ°å°æ’åº
    :param templateType: éå¿…å¡«ï¼Œæ¨¡æ¿ç±»å‹ï¼Œå–å€¼ï¼š0ï¼ˆå½•åˆ¶æ¨¡ç‰ˆï¼‰, 1ï¼ˆæˆªå›¾æ¨¡ç‰ˆï¼‰
    :param match: éå¿…å¡«ï¼Œæ¨¡ç³ŠåŒ¹é…æŸ¥è¯¢(æ¨¡ç‰ˆåç§°åŒ…å«matchä¸²æ—¶è¿”å›)

    :return:
        200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    start = time2timestamp(startDate)

    end = time2timestamp(endDate)

    if marker is None:
        # è¯·æ±‚URL
        url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}/recordhistories?start={start}&end={end}&line={line}"
    else:
        url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}/recordhistories?start={start}&end={end}&marker={marker}&line={line}"
    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    headers = {"code": res.status_code, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # æµID
    streamId = "xxxxxxxxxxx"

    # æ¨æµå¼€å§‹æ—¶é—´ï¼ˆUnix æ—¶é—´æˆ³ï¼‰
    startDate = "2020-06-08 00:00:00"

    # æ¨æµç»“æŸæ—¶é—´ï¼ˆUnix æ—¶é—´æˆ³ï¼‰
    endDate = "2020-06-09 00:00:00"

    headers, result = recordHistories(access_key, secret_key, namespaceId, streamId, startDate, endDate)
    print(f'{headers}\n{result}')
```
<br/>

## **[æŸ¥è¯¢æµå°é¢](https://developer.qiniu.com/qvs/api/6814/the-cover-for-screenshots)**



### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json, time


# æ—¥æœŸè½¬æ—¶é—´æˆ³
def time2timestamp(datetime):
    # è½¬ä¸ºæ—¶é—´æ•°ç»„
    timeArray = time.strptime(datetime, "%Y-%m-%d %H:%M:%S")
    timeStamp = int(time.mktime(timeArray))
    return timeStamp


def streamSnapshotss(access_key, secret_key, namespaceId, streamId):
    """
    è·å–ç›´æ’­å°é¢æˆªå›¾
    https://developer.qiniu.com/qvs/api/6814/the-cover-for-screenshots
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: å¿…å¡«é¡¹ï¼Œç©ºé—´ID
    :param streamId: å¿…å¡«é¡¹ï¼ŒæµID

    :return:
        200
            {
                "url": "http://prlghu509.test.bkt.clouddn.com/snapshot/jpg/2akrarrzns76w/t0.jpg?e=1588124787&token=Ves3WTXC8XnEHT0I_vacEQQz-9jrJZxNExcmarzQ:bH8s5m5N5Ugp2wo6ACRUVeIK280"
            }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    # è¯·æ±‚URL
    url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}/cover"

    # å‘èµ·GETè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    result = json.loads(res.text_body)
    if res.status_code == 401:
        headers = {"code": res.status_code, "reqid": res.req_id, "error": result["error"]}
    elif res.status_code != 401 and res.text_body:
        headers = {"code": result["code"], "reqid": res.req_id, "xlog": result["error"]}
    else:
        headers = {"code": res.text_body, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # æµID
    streamId = "xxxxxxxxxxx"

    headers, result = streamSnapshotss(access_key, secret_key, namespaceId, streamId)
    print(f'{headers}\n{result}')
```


## **[è·å–æˆªå›¾åˆ—è¡¨](https://developer.qiniu.com/qvs/api/6749/list-stream-snapshots)**


### ç¤ºä¾‹

```python
# -*- coding: utf-8 -*-
from qiniu import QiniuMacAuth, http
import json, time


# æ—¥æœŸè½¬æ—¶é—´æˆ³
def time2timestamp(datetime):
    # è½¬ä¸ºæ—¶é—´æ•°ç»„
    timeArray = time.strptime(datetime, "%Y-%m-%d %H:%M:%S")
    timeStamp = int(time.mktime(timeArray))
    return timeStamp


def streamSnapshots(access_key, secret_key, namespaceId, streamId, startDate, endDate, type, line=30, marker=None):
    """
    è·å–æˆªå›¾åˆ—è¡¨
    https://developer.qiniu.com/qvs/api/6749/list-stream-snapshots
    :param access_key: å…¬é’¥
    :param secret_key: ç§é’¥
    :param namespaceId: å¿…å¡«é¡¹ï¼Œç©ºé—´ID
    :param streamId: å¿…å¡«é¡¹ï¼ŒæµID
    :param type: å¿…å¡«é¡¹ï¼Œ1:å®æ—¶æˆªå›¾å¯¹åº”çš„å›¾ç‰‡åˆ—è¡¨
    :param line: éå¿…å¡«ï¼Œé™å®šè¿”å›æˆªå›¾çš„ä¸ªæ•°ï¼Œåªèƒ½è¾“å…¥1-100çš„æ•´æ•°ï¼Œä¸æŒ‡å®šé»˜è®¤è¿”å›30ä¸ª
    :param startDate:  å¿…å¡«é¡¹ï¼ŒæŸ¥è¯¢å¼€å§‹æ—¶é—´(unixæ—¶é—´æˆ³,å•ä½ä¸ºç§’)
    :param endDate: å¿…å¡«é¡¹ï¼ŒæŸ¥è¯¢ç»“æŸæ—¶é—´(unixæ—¶é—´æˆ³,å•ä½ä¸ºç§’)
    :param marker: éå¿…å¡«ï¼Œä¸Šä¸€æ¬¡æŸ¥è¯¢è¿”å›çš„æ ‡è®°ï¼Œç”¨äºæç¤ºæœåŠ¡ç«¯ä»ä¸Šä¸€æ¬¡æŸ¥åˆ°çš„ä½ç½®ç»§ç»­æŸ¥è¯¢ï¼Œä¸æŒ‡å®šè¡¨ç¤ºä»å¤´æŸ¥è¯¢

    :return:
        200 { }
    """
    auth = QiniuMacAuth(access_key, secret_key)

    start = time2timestamp(startDate)

    end = time2timestamp(endDate)

    if marker is None:
        # è¯·æ±‚URL
        url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}/snapshots?type={type}&start={start}&end={end}&line={line}"
    else:
        url = f"http://qvs.qiniuapi.com/v1/namespaces/{namespaceId}/streams/{streamId}/snapshots?type={type}&start={end}&end={end}&line={line}&marker={marker}"
    # å‘èµ·POSTè¯·æ±‚
    ret, res = http._get_with_qiniu_mac(url, params=None, auth=auth)
    if res.text_body:
        result = json.loads(res.text_body)
        headers = {"code": result["code"], "reqid": res.req_id, "xlog": result["error"]}
    else:
        headers = {"code": res.text_body, "reqid": res.req_id, "xlog": res.x_log, "text_body": res.text_body}

    # æ ¼å¼åŒ–å“åº”ä½“
    Headers = json.dumps(headers, indent=4, ensure_ascii=False)
    result = json.dumps(ret, indent=4, ensure_ascii=False)
    return Headers, result

if __name__ == '__main__':
    # ä¸ƒç‰›è´¦å· AKã€SK
    access_key = '<access_key>'
    secret_key = '<secret_key>'

    # ç©ºé—´ID
    namespaceId = "xxxxxxxxxxx"

    # æµID
    streamId = "xxxxxxxxxxx"

    # 1:å®æ—¶æˆªå›¾å¯¹åº”çš„å›¾ç‰‡åˆ—è¡¨
    type = 1

    # æ¨æµå¼€å§‹æ—¶é—´ï¼ˆUnix æ—¶é—´æˆ³ï¼‰
    startDate = "2020-06-08 00:00:00"

    # æ¨æµç»“æŸæ—¶é—´ï¼ˆUnix æ—¶é—´æˆ³ï¼‰
    endDate = "2020-06-09 00:00:00"

    headers, result = streamSnapshots(access_key, secret_key, namespaceId, streamId, startDate, endDate, type)
    print(f'{headers}\n{result}')
```