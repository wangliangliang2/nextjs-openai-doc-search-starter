  <h1 font-weigh = "bold" id="sXprA">概述</h1><p>本文主要介绍在不同操作系统中检查TCP 80端口是否正常工作的方法。</p><h1 font-weigh = "bold" id="NxfMT">详细信息</h1><blockquote><p data-spm-anchor-id="a2c9r.12641779.0.i0.1badSS8aSS8aLc">七牛云提醒您：</p><ul><li data-spm-anchor-id="a2c9r.12641779.0.i0.2374r1w1r1w1Mp">如果您对实例或数据有修改、变更等风险操作，务必注意实例的容灾、容错能力，确保数据安全。</li><li data-spm-anchor-id="a2c9r.12641779.0.i0.b170EQFdEQFdJ5">如果您对实例（包括但不限于QVM、RDS）等进行配置与数据修改，建议提前创建快照或开启RDS日志备份等功能。</li><li data-spm-anchor-id="a2c9r.12641779.0.i2.1badSS8aSS8aLc">如果您在七牛云平台授权或者提交过登录账号、密码等安全信息，建议您及时修改。</li></ul></blockquote><p>如果实例无法对外提供HTTP服务，可以按以下思路检查Web服务相关的接口（默认为TCP 80）是否正常工作。</p><ol><li>在QVM管理控制台，确认安全组已经放行该端口。</li><li>远程连接QVM实例，确认服务已经开启。</li><li>确认端口正常被监听。如没有，请修改监听地址。</li><li>确认实例防火墙已经放行服务。</li><li>若仍无法解决，请提交工单咨询。</li></ol><p>本文分别介绍在以下不同操作系统中检查TCP 80端口是否正常工作的方法：</p><ul><li><a class="from-extensions-error" href="#win2012">Windows Server 2012</a></li><li><a class="from-extensions-error" href="#win2008">Windows Server 2008</a></li><li><a class="from-extensions-error" href="#centos">CentOS 7.3</a></li><li><a class="from-extensions-error" href="#ubuntu">Ubuntu 16.04</a></li></ul><p>以下是在Windows Server 2012系统中检查TCP 80端口是否正常工作的方法。</p><h2 font-weigh = "bold" id="win2012">Windows Server 2012</h2><blockquote><p><strong>说明</strong>：在Windows 2012系统的Windows实例中安装IIS服务为例。</p></blockquote><ol><li><p>登录<a class="from-extensions-error" title="点击进入 QVM 管理控制台" href="https://portal.qiniu.com/qvm/dashboard">QVM 管理控制台</a>，确认实例所在安全组里已经添加以下安全组规则。</p><table><tbody><tr><th>网络类型</th><th>网卡类型</th><th>规则方向</th><th>授权策略</th><th>协议类型</th><th>端口范围</th><th>授权类型</th><th>授权对象</th><th>优先级</th></tr><tr><td>VPC 网络</td><td>不需要配置</td><td rowspan="2">入方向</td><td rowspan="2">允许</td><td rowspan="2">HTTP(80)</td><td rowspan="2">80/80</td><td rowspan="2">地址段访问</td><td rowspan="2">10.0.0.0/8</td><td rowspan="2">1</td></tr><tr><td>经典网络</td><td>公网</td></tr></tbody></table></li><li><p>参见<a>远程连接 Windows 实例</a>，登录Windows实例。</p></li><li><p>以下是查看IIS服务是否已经开启的操作步骤：</p><ol><li>在<strong>服务器管理器</strong>窗口，单击<strong>工具</strong>&gt;<strong>Internet Information Services (IIS)管理器</strong>。如果找不到这个选项，则说明没有成功安装IIS服务，需要重新安装IIS服务。<br><img src="http://qey2kbifv.hn-bkt.clouddn.com/2020-08-13/Z2rvROYlhGmnIg7qds8a.png" alt="Windows2012_确认已安装IIS服务"></li><li>在<strong>Internet Information Services (IIS)管理器</strong>窗口中确认以下信息：<ul><li>在<strong>连接</strong>导航栏里，右键单击实例ID，如果<strong>启动</strong>处于灰色状态，表示IIS服务已经开启。</li><li>单击<strong>网站</strong>，在右边列表页查看您安装的网站的状态。如果网站<strong>状态</strong>为<strong>已停止</strong>，则单击网站，在右侧<strong>操作</strong>栏的<strong>管理站点</strong>部分，单击<strong>启动</strong>，启动网站。<br><img src="http://qey2kbifv.hn-bkt.clouddn.com/2020-08-13/Z1UW9Tsm7hyYRSoAOn3G.png" alt="Windows2012_确认站点已启动"></li></ul></li></ol></li><li><p>以下是查看端口在实例中是否正常被监听的操作步骤：</p><ol><li>启动<strong>命令提示符</strong>。</li><li>执行以下命令。<pre>netstat -ano | findstr :80</pre>如果返回类似<code>TCP 0.0.0.0:80 0.0.0.0:0 LISTENING 4</code>，则说明80端口正常全网监听。如果返回的不是该端口，请在Internet Information Services (IIS)管理器窗口中，单击指定网站，然后单击右侧<strong>操作</strong>栏中的<strong>绑定</strong>，将绑定的端口该为80端口。</li></ol></li><li><p>以下是查看实例里防火墙是否已经放行Web服务的操作步骤：</p><ol><li>单击<strong>控制面板</strong>&gt;<strong>系统与安全</strong>&gt;<strong>Windows 防火墙</strong>。</li><li>根据防火墙状态，执行不同操作。<ul><li>如果防火墙处于关闭状态，不需要再做其他处理。如果仍无法访问网站，请提交工单</a>咨询。</li><li>如果防火墙处于开启状态，则执行以下操作。<ol><li>单击<strong>高级设置</strong>。</li><li>在弹出窗口的左侧导航栏中，单击<strong>入站规则</strong>。</li><li>选择<strong>万维网服务（HTTP 流入量）</strong>，如果处于禁用状态，在<strong>操作</strong>栏里，单击<strong>启用规则</strong>。<br><img src="http://qey2kbifv.hn-bkt.clouddn.com/2020-08-13/NF5lI69zxC01D4dpYqrT.png" alt="Windows2012_防火墙里启用HTTP入站规则"></li></ol></li></ul></li></ol></li><li>完成上述检查，如果仍不能访问实例，请提交工单</a>咨询。</li></ol><p id="GxyPN">以下是在Windows Server 2008系统中检查TCP 80端口是否正常工作的方法。</p><h2 font-weigh = "bold" id="win2008">Windows Server 2008</h2><blockquote><p><strong>说明</strong>：以在Windows 2008系统的Windows实例中安装IIS服务为例。</p></blockquote><ol><li><p>登录<a class="from-extensions-error" title="点击进入 QVM 管理控制台" href="https://portal.qiniu.com/qvm/dashboard">QVM 管理控制台</a>，确认实例所在安全组里已经添加以下安全组规则。</p><table><tbody><tr><th>网络类型</th><th>网卡类型</th><th>规则方向</th><th>授权策略</th><th>协议类型</th><th>端口范围</th><th>授权类型</th><th>授权对象</th><th>优先级</th></tr><tr><td>VPC 网络</td><td>不需要配置</td><td rowspan="2">入方向</td><td rowspan="2">允许</td><td rowspan="2">HTTP(80)</td><td rowspan="2">80/80</td><td rowspan="2">地址段访问</td><td rowspan="2">10.0.0.0/8</td><td rowspan="2">1</td></tr><tr><td>经典网络</td><td>公网</td></tr></tbody></table></li><li>参见<a>远程连接 Windows 实例</a>，登录Windows实例。</li><li><p>以下是查看IIS服务是否已经开启的操作步骤。</p><ol><li>在<strong>服务器管理器</strong>窗口，选择<strong>角色</strong>&gt;<strong>Web 服务器</strong>。如果找不到这个选项，则说明没有成功安装IIS服务。</li><li>在<strong>Web 服务器</strong>窗口，确认<strong>系统服务</strong>部分显示为<strong>全部正在运行</strong>。如果不是这个状态，请启动所有服务。<br><img src="http://qey2kbifv.hn-bkt.clouddn.com/2020-08-13/MPSqNCZrDL3WY1yd2kXx.png" alt="Windows2008_确认已安装IIS服务"></li></ol></li><li><p>以下是查看端口在实例中是否正常被监听的操作步骤。</p><ol><li>启动<strong>命令提示符</strong>。</li><li>执行以下命令。<pre>netstat -ano | findstr :80</pre>如果返回<code>TCP 0.0.0.0:80 0.0.0.0:0 LISTENING 4</code>，则说明80端口正常全网监听。如果返回的不是该端口，请在Internet Information Services (IIS)管理器窗口中，单击指定网站，然后单击右侧<strong>操作</strong>栏中的<strong>绑定</strong>，将绑定的端口该为80端口。</li></ol></li><li><p>以下是查看实例里防火墙是否已经放行Web服务的操作步骤。</p><ol><li>单击<strong>控制面板</strong>&gt;<strong>系统与安全</strong>&gt;<strong>检查防火墙状态</strong>。</li><li>根据防火墙状态，执行不同操作。<ul><li>如果防火墙处于关闭状态，不需要再做其他处理。如果仍无法访问网站，请提交工单咨询。</li><li>如果防火墙处于开启状态，则执行以下操作。<ol><li>单击<strong>高级设置</strong>。</li><li>在弹出窗口的左侧导航栏中，单击<strong>入站规则</strong>。</li><li>选择<strong>万维网服务（HTTP 流入量）</strong>，如果处于禁用状态，在<strong>操作</strong>栏里，单击<strong>启用规则</strong>。<br><img src="http://qey2kbifv.hn-bkt.clouddn.com/2020-08-13/awf3J5Zi8hBE7WyoTzm9.png" alt="Windows2008_防火墙里启用HTTP入站规则"></li></ol></li></ul></li></ol></li><li>完成上述检查，如果仍不能访问实例，请提交工单咨询。</li></ol><p>以下是在CentOS 7.3系统中检查TCP 80端口是否正常工作的方法。</p><h2 font-weigh = "bold" id="centos">CentOS 7.3</h2><blockquote><p><strong>说明</strong>：以在CentOS 7.3系统的Linux实例中安装Nginx服务为例。</p></blockquote><ol><li><p>登录<a class="from-extensions-error" title="点击进入 QVM 管理控制台" href="https://portal.qiniu.com/qvm/dashboard">QVM 管理控制台</a>，确认实例所在安全组里已经添加以下安全组规则。</p><table style="height: 123px;"><tbody><tr style="height: 33px;"><th style="height: 33px; width: 90.6667px;">网络类型</th><th style="height: 33px; width: 92px;">网卡类型</th><th style="height: 33px; width: 90.6667px;">规则方向</th><th style="height: 33px; width: 90.6667px;">授权策略</th><th style="height: 33px; width: 90.6667px;">协议类型</th><th style="height: 33px; width: 90.6667px;">端口范围</th><th style="height: 33px; width: 92px;">授权类型</th><th style="height: 33px; width: 92px;">授权对象</th><th style="height: 33px; width: 90.6667px;">优先级</th></tr><tr style="height: 57px;"><td style="height: 57px; width: 90.6667px;">VPC 网络</td><td style="height: 57px; width: 92px;">不需要配置</td><td style="height: 90px; width: 90.6667px;" rowspan="2">入方向</td><td style="height: 90px; width: 90.6667px;" rowspan="2">允许</td><td style="height: 90px; width: 90.6667px;" rowspan="2">HTTP(80)</td><td style="height: 90px; width: 90.6667px;" rowspan="2">80/80</td><td style="height: 90px; width: 92px;" rowspan="2">地址段访问</td><td style="height: 90px; width: 92px;" rowspan="2">10.0.0.0/8</td><td style="height: 90px; width: 90.6667px;" rowspan="2">1</td></tr><tr style="height: 33px;"><td style="height: 33px; width: 90.6667px;">经典网络</td><td style="height: 33px; width: 92px;">公网</td></tr></tbody></table></li><li>参见<a>远程连接 Linux实例</a>，登录Linux实例。</li><li><p>执行以下运行命令。</p><pre>systemctl status nginx</pre>如果系统返回类似如下，则说明Nginx已经启动。如果未开启，则执行<code>systemctl start nginx</code>命令。<br><img src="http://qey2kbifv.hn-bkt.clouddn.com/2020-08-13/r1HPOURpGbYZ7LA68Kcd.png" alt="CentOS7.3_nginx已启动"></li><li><p><span style="font-size: 14px; letter-spacing: 0.05em;">执行以下命令，查看端口在实例中是否正常被监听。</span></p><pre>netstat -an | grep 80</pre>如果返回<code>tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN</code>，则说明80端口正常全网监听。如果返回的不是上述结果，请修改监听地址。关于如何修改监听地址，请参见<a>如何修改Nginx服务端口监听地址</a>。</li><li><p>CentOS 7之后的版本默认安装Firewalld。如果已经启用<code>firewalld.service</code>，则需要放行 TCP 80 端口。执行以下命令。若返回结果为<code>success</code>，则表示已经放行TCP 80端口。</p><pre>firewall-cmd --add-port=80/tcp --permanent</pre><blockquote><p>使用CentOS 7之前的版本并开启默认防火墙iptables时，应注意iptables默认不拦截访问，如果配置了iptables规则，需要执行以下步骤。</p><ol><li>查看规则列表：执行命令 <code>iptables --line -vnL</code>。根据返回结果执行不同操作。<ul><li>如果设置了默认拦截，添加规则放行TCP 80端口。执行命令<code>iptables -A INPUT -p tcp --dport 80 -j ACCEPT</code>。</li><li>如果设置了DROP TCP 80端口，替换规则放行 80 端口。执行命令<code>iptables -R INPUT [80端口对应的规则编号] -p tcp --dport 80 -j ACCEPT</code>。</li></ul></li><li>保存上述规则，执行命令 <code>service iptables save</code>。</li></ol></blockquote></li><li>完成上述检查，如果仍不能访问实例，请提交工单</a>咨询。</li></ol><p>以下是在Ubuntu 16.04系统中检查TCP 80端口是否正常工作的方法。</p><h2 font-weigh = "bold" id="ubuntu">Ubuntu 16.04</h2><blockquote><p><strong>说明</strong>：以在Ubuntu 16.04系统的Linux实例中安装Apache2 Web服务器为例。</p></blockquote><ol><li><p>登录<a class="from-extensions-error" title="点击进入 QVM 管理控制台" href="https://portal.qiniu.com/qvm/dashboard">QVM 管理控制台</a>，确认实例所在安全组里已经添加以下安全组规则。</p><table><tbody><tr><th>网络类型</th><th>网卡类型</th><th>规则方向</th><th>授权策略</th><th>协议类型</th><th>端口范围</th><th>授权类型</th><th>授权对象</th><th>优先级</th></tr><tr><td>VPC 网络</td><td>不需要配置</td><td rowspan="2">入方向</td><td rowspan="2">允许</td><td rowspan="2">HTTP(80)</td><td rowspan="2">80/80</td><td rowspan="2">地址段访问</td><td rowspan="2">10.0.0.0/8</td><td rowspan="2">1</td></tr><tr><td>经典网络</td><td>公网</td></tr></tbody></table></li><li>参见<a>远程连接 Linux实例</a>，登录Linux实例。</li><li><p>查看Apache2 Web服务器是否已经开启。执行命令<code>service apache2 status</code>。如果返回以下结果，说明 Apache2 Web服务器已经启动。如果未开启，执行命令 <code>service apache2 start</code>。<br><img src="http://qey2kbifv.hn-bkt.clouddn.com/2020-08-13/KNcxI6uHCOjfgFWLeAv1.png" alt="Ubuntu 16.04_Apache2 Web 服务器正常工作"></p></li><li><p><span style="font-size: 14px; letter-spacing: 0.05em;">执行以下命令，查看端口在实例中是否正常被监听。</span></p><pre>netstat -an | grep 80</pre>如果返回<code>tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN</code>，则说明80端口正常全网监听。如果返回的不是上述结果，请修改监听地址。关于如何修改监听地址，请参见<a>如何修改Apache服务端口监听地址</a>。</li><li><p>如果您已经启用UFW（Ubuntu 预装防火墙），需要放行TCP 80端口或HTTP服务。执行命令<code>ufw allow 80/tcp</code>或<code>ufw allow http</code>。返回结果为<code>Rule added</code> 表示已经放行TCP 80端口或HTTP服务。</p><blockquote><p><strong>说明</strong>：如果实例中已经安装Firewalld并且已经启用firewalld.service，若需要放行 TCP 80 端口，执行命令<code>firewall-cmd --add-port=80/tcp --permanent</code>。返回结果为<code>success</code>即表示已经放行TCP 80端口。</p></blockquote></li><li>完成上述检查，如果仍不能访问实例，请提交工单</a>咨询。</li></ol><h1 font-weigh = "bold" id="EFZrM">适用于</h1><ul><li>云服务器QVM</li></ul>  </div>              	