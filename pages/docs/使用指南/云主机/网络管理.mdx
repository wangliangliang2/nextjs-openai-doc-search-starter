<a id="step01"></a>
# **设置访问模式**

RDS 支持标准模式和高安全模式两种访问模式。本文主要介绍两种访问模式的区别及修改方法。

- 标准模式：RDS 使用负载均衡屏蔽了数据库引擎 HA 切换对应用层的影响，缩短响应时间，但会小幅度增加连接闪断的概率。该模式只支持一种连接地址，在实例同时有内网地址和外网地址的情况下，需先释放内网地址或者外网地址后，才能切换到标准模式。

- 高安全模式：可防止 90% 的连接闪断，但是会增加20%以上响应时间，有一定的性能损耗。该模式支持内外网地址并存。

使用说明：

- MySQL 5.7 版本的实例的访问模式是标准模式，不支持访问模式的切换。

- 在切换访问模式时，RDS 服务可能会出现 1 次 30 秒的闪断，请你尽量在业务低峰执行升级操作，或确保你的应用有自动重连机制，以避免闪断造成的影响。

修改访问模式的操作步骤：

**1. **登录[ RDS 管理控制台](https://portal.qiniu.com/qvm/db/rds)

**2. **单击目标实例的 ID/名称，进入实例信息页面

**3. **找到**网络信息**框，单击**访问模式**后的**修改**

**4. **在弹出的修改访问模式窗口，单击**确定**

<br>

<a id="step02"></a>
# **申请外网地址**

如果你的应用部署在与你的 RDS 实例在同一地域且网络类型相同的主机上，则无需申请外网地址。如果你的应用部署在与你的 RDS 实例在不同地域或网络类型不同的主机或者七牛云以外的系统上，需申请外网地址，用于应用对接。

RDS 提供两种连接地址，即内网地址和外网地址。实例的访问模式和实例版本对连接地址的选择有如下限制。

| 实例系列 | 实例版本 | 访问模式和连接地址 |
| ---------- | ----------- | ----------- | ----------- |
| 单机基础版 | <li>MySQL 5.7</li> <li>SQL Server 2012</li> | 标准模式 <li>内网地址</li><li>外网地址</li><li>内网地址和外网地址 |
| 双机高可用版 | <li>MySQL 5.5/5.6</li> <li>SQL Server 2008 R2</li><li>PostgreSQL 9.4</li><li>PPAS 9.3</li> | 标准模式 <li>内网地址</li><li>外网地址</li><li>内网地址和外网地址</li><br>高安全模式<li>内网地址</li><li>外网地址</li><li>内网地址和外网地址 |
| 金融版 | MySQL 5.6 | 标准模式 <li>内网地址</li><li>外网地址</li><br>高安全模式<li>内网地址</li><li>外网地址</li><li>内网地址和外网地址 |

说明：

- 单独使用内网地址

 - 系统默认提供内网地址，你可以直接修改连接地址。

 - 适用于应用部署在与你的 RDS 实例在同一地域的云主机上且 RDS 实例与云主机的网络类型相同时。

- 单独使用外网地址

 - 适用于应用部署在与你的 RDS 在不同地域的云主机上时。

 - 适用于应用部署在七牛云以外的系统上时。

- 同时使用内外网地址

 - 适用于应用中的模块同时部署在与你的 RDS 实例在同一地域且网络类型相同的云主机上和与你的 RDS 实例在不同的云主机上时。

 - 适用于应用中的模块同时部署在与你的 RDS 实例在同一地域且网络类型相同的云主机上和七牛云以外的系统上时。
 
提醒：

- 在访问数据库前，你需要将访问数据库的 IP 地址或者 IP 段加入白名单，操作请参考[设置白名单](#step02)。

- 外网地址会降低实例的安全性，请谨慎选择。为了获得更快的传输速率和更高的安全级别，建议你将应用迁移到与你的 RDS 在同一地域的七牛云主机上。

**1. **登录[ RDS 管理控制台](https://portal.qiniu.com/qvm/db/rds)

**2. **单击目标实例的 ID，进入实例信息页面

**3. **找到**网络信息**框，单击**申请公网连接串**

**4. **在弹出的信息确认框中单击**确定**，生成外网地址。

外网地址样式为`xxx.mysql.rds.aliyuncs.com:3306`，`3306`是 RDS 对外提供服务的端口号。

<br>

<a id="step03"></a>
# **修改内外网连接地址**

**1. **登录[ RDS 管理控制台](https://portal.qiniu.com/qvm/db/rds)

**2. **单击目标实例的 ID，进入实例信息页面

**3. **在**网络信息**模块中，单击**内网地址/外网地址 > 修改**

**4. **在弹出的窗口中设置内外网连接地址及端口号，单击**确定**

- 地址前缀：为自定义字段，由字母和数字组成，开头需小写字母，8~64 个字符

- 端口：RDS 对外提供服务的端口号，取值范围是 3200~3999 之间的任意一个整数

<br>

<a id="step04"></a>
# **释放外网地址**

**1. **登录[ RDS 管理控制台](https://portal.qiniu.com/qvm/db/rds)

**2. **单击目标实例的 ID，进入实例信息页面

**3. **在**网络信息**模块中，单击**外网地址 > 释放**

**4. **在弹出的确认信息界面单击**确定**，释放外网地址